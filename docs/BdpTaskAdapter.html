<!DOCTYPE html>
<html lang="en">
<head>
    
    <meta charset="utf-8">
    <title>BdpTaskAdapter - Documentation</title>
    
    
    <script src="scripts/prettify/prettify.js"></script>
    <script src="scripts/prettify/lang-css.js"></script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc.css">
    <script src="scripts/nav.js" defer></script>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
</head>
<body>

<input type="checkbox" id="nav-trigger" class="nav-trigger" />
<label for="nav-trigger" class="navicon-button x">
  <div class="navicon"></div>
</label>

<label for="nav-trigger" class="overlay"></label>

<nav >
    
    <input type="text" id="nav-search" placeholder="Search" />
    
    <h2><a href="index.html">Home</a></h2><h2><a href="https://github.com/big-data-processor/task-adapter-base" target="_blank" class="menu-item" id="github-repo" >Github Repo</a></h2><h3>Classes</h3><ul><li><a href="BdpTaskAdapter.html">BdpTaskAdapter</a><ul class='methods'><li data-type='method'><a href="BdpTaskAdapter.html#._addTasks">_addTasks</a></li><li data-type='method'><a href="BdpTaskAdapter.html#._checkStatus">_checkStatus</a></li><li data-type='method'><a href="BdpTaskAdapter.html#._loadProcessIndex">_loadProcessIndex</a></li><li data-type='method'><a href="BdpTaskAdapter.html#._monitorTasks">_monitorTasks</a></li><li data-type='method'><a href="BdpTaskAdapter.html#._parseRecipe">_parseRecipe</a></li><li data-type='method'><a href="BdpTaskAdapter.html#._processAfterExitCallback">_processAfterExitCallback</a></li><li data-type='method'><a href="BdpTaskAdapter.html#._processBeforeExitCallback">_processBeforeExitCallback</a></li><li data-type='method'><a href="BdpTaskAdapter.html#._resumeRemoteTasks">_resumeRemoteTasks</a></li><li data-type='method'><a href="BdpTaskAdapter.html#._runProcess">_runProcess</a></li><li data-type='method'><a href="BdpTaskAdapter.html#._runTasks">_runTasks</a></li><li data-type='method'><a href="BdpTaskAdapter.html#._setOptions">_setOptions</a></li><li data-type='method'><a href="BdpTaskAdapter.html#._waitingJobStatus">_waitingJobStatus</a></li><li data-type='method'><a href="BdpTaskAdapter.html#._writeTaskLogs">_writeTaskLogs</a></li><li data-type='method'><a href="BdpTaskAdapter.html#.beforeExit">beforeExit</a></li><li data-type='method'><a href="BdpTaskAdapter.html#.beforeStart">beforeStart</a></li><li data-type='method'><a href="BdpTaskAdapter.html#.detectJobStatus">detectJobStatus</a></li><li data-type='method'><a href="BdpTaskAdapter.html#.initialize">initialize</a></li><li data-type='method'><a href="BdpTaskAdapter.html#.printStatus">printStatus</a></li><li data-type='method'><a href="BdpTaskAdapter.html#.processExitCallback">processExitCallback</a></li><li data-type='method'><a href="BdpTaskAdapter.html#.processSpawn">processSpawn</a></li><li data-type='method'><a href="BdpTaskAdapter.html#.taskOverrides">taskOverrides</a></li></ul></li><li></li></ul><h3>Global</h3><ul><li><a href="global.html#AdapterOption">AdapterOption</a></li><li><a href="global.html#BatchStatus">BatchStatus</a></li><li><a href="global.html#FileHandler">FileHandler</a></li><li><a href="global.html#globalReadlineInterface">globalReadlineInterface</a></li><li><a href="global.html#ProcessExit">ProcessExit</a></li><li><a href="global.html#ProcessRunning">ProcessRunning</a></li><li><a href="global.html#TaskDefinition">TaskDefinition</a></li></ul>
</nav>

<div id="main">
    
    <h1 class="page-title">BdpTaskAdapter</h1>
    

    




<section>

<header>
    
        <h2>
        BdpTaskAdapter
        </h2>
        
    
</header>

<article>
    
        <div class="container-overview">
        
            

    

    <h4 class="name" id="BdpTaskAdapter"><span class="type-signature"></span>new BdpTaskAdapter<span class="signature">()</span><span class="type-signature"></span></h4>

    




<dl class="details">

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="index.js.html">index.js</a>, <a href="index.js.html#line122">line 122</a>
    </li></ul></dd>
    

    

    

    

    

    

    

    

    

    
    <dt class="tag-author">Author:</dt>
    <dd class="tag-author">
        <ul>
            <li><a href="mailto:chiyang1118@gmail.com">Chi Yang</a></li>
        </ul>
    </dd>
    

    

    
    <dt class="tag-license">License:</dt>
    <dd class="tag-license"><ul class="dummy"><li>MITCopyright (c) 2020 Chi Yang(楊崎) <chiyang1118@gmail.com>Permission is hereby granted, free of charge, to any person obtaining a copyof this software and associated documentation files (the "Software"), to dealin the Software without restriction, including without limitation the rightsto use, copy, modify, merge, publish, distribute, sublicense, and/or sellcopies of the Software, and to permit persons to whom the Software isfurnished to do so, subject to the following conditions:The above copyright notice and this permission notice shall be included in allcopies or substantial portions of the Software.THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS ORIMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THEAUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHERLIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THESOFTWARE.</li></ul></dd>
    

    

    

    

    
</dl>
































        
        </div>
    

    

    

    
    
    

     

    

    
        <h3 class="subsection-title">Members</h3>

        
            
<h4 class="name" id=".concurrencyDelayCount"><span class="type-signature">(static) </span>concurrencyDelayCount<span class="type-signature"> :number</span></h4>





<dl class="details">

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="index.js.html">index.js</a>, <a href="index.js.html#line164">line 164</a>
    </li></ul></dd>
    

    

    

    

    

    

    

    

    

    

    

    

    
    <dt class="tag-default">Default Value:</dt>
    <dd class="tag-default"><ul class="dummy">
            <li>1</li>
        </ul></dd>
    

    

    

    
</dl>





<div class="description usertext">
    <p>In case of setting a high concurrency number that causes submitting too many jobs at one time.
We added 1 to a delay count each time a job is sent. The job will be held for a delay interval times this delay count before it is processed.
In this way, even if there are so many jobs in a queue are submitted concurrently, the actual commands are delayed and processed one by one with the time interval.
Once a job is finished, there will be a small waiting time to determine whether the job submitting events are frequent.
If the event is not frequent, meaning that the <code>delayCount</code> remains the same after the waiting duration, the delayCount will be reset to 0.</p>
</div>



    <h5>Type:</h5>
    <ul>
        <li>
            
<span class="param-type">number</span>


        </li>
    </ul>






        
            
<h4 class="name" id=".delayInterval"><span class="type-signature">(static) </span>delayInterval<span class="type-signature"> :number</span></h4>





<dl class="details">

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="index.js.html">index.js</a>, <a href="index.js.html#line174">line 174</a>
    </li></ul></dd>
    

    

    

    

    

    

    

    

    

    

    

    

    
    <dt class="tag-default">Default Value:</dt>
    <dd class="tag-default"><ul class="dummy">
            <li>300</li>
        </ul></dd>
    

    

    

    
</dl>





<div class="description usertext">
    <p>This is a delay interval in milliseconds for concurrent job submission.
This prevents submitting too many jobs concurrently, especially when there are too many concurrent jobs to be submitted.
This can be set via options.</p>
</div>



    <h5>Type:</h5>
    <ul>
        <li>
            
<span class="param-type">number</span>


        </li>
    </ul>






        
            
<h4 class="name" id=".previousStatus"><span class="type-signature">(static) </span>previousStatus<span class="type-signature"> :<a href="global.html#BatchStatus">BatchStatus</a></span></h4>





<dl class="details">

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="index.js.html">index.js</a>, <a href="index.js.html#line184">line 184</a>
    </li></ul></dd>
    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    
</dl>





<div class="description usertext">
    <p>This object stores the progress of batch tasks.</p>
</div>



    <h5>Type:</h5>
    <ul>
        <li>
            
<span class="param-type"><a href="global.html#BatchStatus">BatchStatus</a></span>


        </li>
    </ul>






        
            
<h4 class="name" id=".queue"><span class="type-signature">(static) </span>queue<span class="type-signature"> :queue</span></h4>





<dl class="details">

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="index.js.html">index.js</a>, <a href="index.js.html#line198">line 198</a>
    </li></ul></dd>
    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    
</dl>





<div class="description usertext">
    <p>A queue object from https://www.npmjs.com/package/queue</p>
</div>



    <h5>Type:</h5>
    <ul>
        <li>
            
<span class="param-type">queue</span>


        </li>
    </ul>






        
            
<h4 class="name" id=".taskLogs"><span class="type-signature">(static) </span>taskLogs<span class="type-signature"> :Object.&lt;string, <a href="global.html#TaskDefinition">TaskDefinition</a>></span></h4>





<dl class="details">

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="index.js.html">index.js</a>, <a href="index.js.html#line158">line 158</a>
    </li></ul></dd>
    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    
</dl>





<div class="description usertext">
    <p>This is where</p>
</div>



    <h5>Type:</h5>
    <ul>
        <li>
            
<span class="param-type">Object.&lt;string, <a href="global.html#TaskDefinition">TaskDefinition</a>></span>


        </li>
    </ul>






        
    

    
        <h3 class="subsection-title">Methods</h3>

        
            

    

    <h4 class="name" id="._addTasks"><span class="type-signature">(async, static) </span>_addTasks<span class="signature">()</span><span class="type-signature"> &rarr; {Array.&lt;<a href="global.html#TaskDefinition">TaskDefinition</a>>}</span></h4>

    




<dl class="details">

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="index.js.html">index.js</a>, <a href="index.js.html#line571">line 571</a>
    </li></ul></dd>
    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    
</dl>





<div class="description usertext">
    <p>An async function that construct each task object in the this.taskLogs</p>
</div>

























<h5>Returns:</h5>

        
<div class="param-desc">
    <p>This process should fill the <code>this.taskLog</code> object with each process.</p>
</div>



<dl class="param-type">
    <dt>
        Type
    </dt>
    <dd>
        
<span class="param-type">Array.&lt;<a href="global.html#TaskDefinition">TaskDefinition</a>></span>


    </dd>
</dl>

    



        
            

    

    <h4 class="name" id="._checkStatus"><span class="type-signature">(async, static) </span>_checkStatus<span class="signature">()</span><span class="type-signature"> &rarr; {<a href="global.html#BatchStatus">BatchStatus</a>}</span></h4>

    




<dl class="details">

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="index.js.html">index.js</a>, <a href="index.js.html#line650">line 650</a>
    </li></ul></dd>
    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    
</dl>





<div class="description usertext">
    <p>This function checks job status and return the latest status object.
If finished/exited jobs detected, emit finish/error event on the this.runningTasks[jobID] eventEmitter.</p>
</div>

























<h5>Returns:</h5>

        
<div class="param-desc">
    <p>The updated batch status.</p>
</div>



<dl class="param-type">
    <dt>
        Type
    </dt>
    <dd>
        
<span class="param-type"><a href="global.html#BatchStatus">BatchStatus</a></span>


    </dd>
</dl>

    



        
            

    

    <h4 class="name" id="._loadProcessIndex"><span class="type-signature">(async, static) </span>_loadProcessIndex<span class="signature">()</span><span class="type-signature"></span></h4>

    




<dl class="details">

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="index.js.html">index.js</a>, <a href="index.js.html#line795">line 795</a>
    </li></ul></dd>
    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    
</dl>





<div class="description usertext">
    <p>This function loads the index.txt file in the <code>options.taskLogFolder</code> to check if jobs are finished with the <code>exitCode</code> of 0 (normal exit).
If the job is finished, then it is skipped. This is used for pipeline resuming if the running pipelines stop unexpectedly.</p>
</div>




























        
            

    

    <h4 class="name" id="._monitorTasks"><span class="type-signature">(async, static) </span>_monitorTasks<span class="signature">(queue)</span><span class="type-signature"></span></h4>

    




<dl class="details">

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="index.js.html">index.js</a>, <a href="index.js.html#line699">line 699</a>
    </li></ul></dd>
    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    
</dl>





<div class="description usertext">
    <p>This function is used to monitor job status and periodically checks job status.</p>
</div>











    <h5>Parameters:</h5>
    

<table class="params">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        

        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>queue</code></td>
            

            <td class="type">
            
            </td>

            

            

            <td class="description last"><p>The real queue object to deal the <code>this.runProcess</code> function of each job.</p></td>
        </tr>

    
    </tbody>
</table>



















        
            

    

    <h4 class="name" id="._parseRecipe"><span class="type-signature">(async, static) </span>_parseRecipe<span class="signature">(taskObj, argumentRecipe)</span><span class="type-signature"> &rarr; {<a href="global.html#TaskDefinition">TaskDefinition</a>}</span></h4>

    




<dl class="details">

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="index.js.html">index.js</a>, <a href="index.js.html#line506">line 506</a>
    </li></ul></dd>
    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    
</dl>





<div class="description usertext">
    <p>This function can be called inside BdpTaskAdapter.taskOverrides when you implement the taskOverrides function.
This function basically parses the recipe file (in yaml format) and overrides the TaskDefinition object. Then, it returns the updated object.
(Note: the original taskObj will be mutated.)</p>
</div>











    <h5>Parameters:</h5>
    

<table class="params">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        

        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>taskObj</code></td>
            

            <td class="type">
            
                
<span class="param-type"><a href="global.html#TaskDefinition">TaskDefinition</a></span>


            
            </td>

            

            

            <td class="description last"></td>
        </tr>

    

        <tr>
            
                <td class="name"><code>argumentRecipe</code></td>
            

            <td class="type">
            
                
<span class="param-type">string</span>


            
            </td>

            

            

            <td class="description last"><p>The recipe file path</p></td>
        </tr>

    
    </tbody>
</table>
















<h5>Returns:</h5>

        


<dl class="param-type">
    <dt>
        Type
    </dt>
    <dd>
        
<span class="param-type"><a href="global.html#TaskDefinition">TaskDefinition</a></span>


    </dd>
</dl>

    



        
            

    

    <h4 class="name" id="._processAfterExitCallback"><span class="type-signature">(async, static) </span>_processAfterExitCallback<span class="signature">(taskID, fileHandler)</span><span class="type-signature"></span></h4>

    




<dl class="details">

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="index.js.html">index.js</a>, <a href="index.js.html#line369">line 369</a>
    </li></ul></dd>
    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    
</dl>





<div class="description usertext">
    <p>This internal function is called after the <code>processExitCallback</code> function.
The default behavior is to store the resulting stdout/stderr files.</p>
</div>











    <h5>Parameters:</h5>
    

<table class="params">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        

        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>taskID</code></td>
            

            <td class="type">
            
                
<span class="param-type">string</span>


            
            </td>

            

            

            <td class="description last"></td>
        </tr>

    

        <tr>
            
                <td class="name"><code>fileHandler</code></td>
            

            <td class="type">
            
                
<span class="param-type"><a href="global.html#FileHandler">FileHandler</a></span>


            
            </td>

            

            

            <td class="description last"></td>
        </tr>

    
    </tbody>
</table>



















        
            

    

    <h4 class="name" id="._processBeforeExitCallback"><span class="type-signature">(async, static) </span>_processBeforeExitCallback<span class="signature">(taskID, fileHandler)</span><span class="type-signature"></span></h4>

    




<dl class="details">

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="index.js.html">index.js</a>, <a href="index.js.html#line325">line 325</a>
    </li></ul></dd>
    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    
</dl>





<div class="description usertext">
    <p>This internal function will be called right after a job has exited (finished or errored) and before the <code>processExitCallback</code> function.
The default behavior is to get the remaining stdout/stderr messages and clean up the streaming resources.</p>
</div>











    <h5>Parameters:</h5>
    

<table class="params">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        

        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>taskID</code></td>
            

            <td class="type">
            
                
<span class="param-type">string</span>


            
            </td>

            

            

            <td class="description last"></td>
        </tr>

    

        <tr>
            
                <td class="name"><code>fileHandler</code></td>
            

            <td class="type">
            
                
<span class="param-type"><a href="global.html#FileHandler">FileHandler</a></span>


            
            </td>

            

            

            <td class="description last"></td>
        </tr>

    
    </tbody>
</table>



















        
            

    

    <h4 class="name" id="._resumeRemoteTasks"><span class="type-signature">(async, static) </span>_resumeRemoteTasks<span class="signature">()</span><span class="type-signature"></span></h4>

    




<dl class="details">

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="index.js.html">index.js</a>, <a href="index.js.html#line843">line 843</a>
    </li></ul></dd>
    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    
</dl>





<div class="description usertext">
    <p>This function trying to fetch remote jobs.
This is perticularly useful when adapter process somehow closed and re-run the same adapter process.
Instead of directly re-creation of non-fnihsing jobs, adapter trys to fetch the job histroy.
Then, the adapter can see if there is a need to re-submit jobs.</p>
</div>




























        
            

    

    <h4 class="name" id="._runProcess"><span class="type-signature">(async, static) </span>_runProcess<span class="signature">(taskID)</span><span class="type-signature"> &rarr; {promise}</span></h4>

    




<dl class="details">

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="index.js.html">index.js</a>, <a href="index.js.html#line428">line 428</a>
    </li></ul></dd>
    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    
</dl>





<div class="description usertext">
    <p>An async function that used to run a single job.</p>
</div>











    <h5>Parameters:</h5>
    

<table class="params">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        

        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>taskID</code></td>
            

            <td class="type">
            
                
<span class="param-type">string</span>


            
            </td>

            

            

            <td class="description last"><p>The auto-generated and uniqe task ID</p></td>
        </tr>

    
    </tbody>
</table>
















<h5>Returns:</h5>

        
<div class="param-desc">
    <p>A promise object that will be resovled when the task is finished normally and will be rejected when the task has errors (exitCode !== 0) or leaves unexpectedly.</p>
</div>



<dl class="param-type">
    <dt>
        Type
    </dt>
    <dd>
        
<span class="param-type">promise</span>


    </dd>
</dl>

    



        
            

    

    <h4 class="name" id="._runTasks"><span class="type-signature">(async, static) </span>_runTasks<span class="signature">()</span><span class="type-signature"></span></h4>

    




<dl class="details">

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="index.js.html">index.js</a>, <a href="index.js.html#line901">line 901</a>
    </li></ul></dd>
    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    
</dl>





<div class="description usertext">
    <p>The core function to initiate the queue to process tasks.</p>
</div>




























        
            

    

    <h4 class="name" id="._setOptions"><span class="type-signature">(static) </span>_setOptions<span class="signature">(options)</span><span class="type-signature"> &rarr; {<a href="global.html#AdapterOption">AdapterOption</a>}</span></h4>

    




<dl class="details">

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="index.js.html">index.js</a>, <a href="index.js.html#line208">line 208</a>
    </li></ul></dd>
    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    
</dl>















    <h5>Parameters:</h5>
    

<table class="params">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        

        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>options</code></td>
            

            <td class="type">
            
                
<span class="param-type"><a href="global.html#AdapterOption">AdapterOption</a></span>


            
            </td>

            

            

            <td class="description last"></td>
        </tr>

    
    </tbody>
</table>
















<h5>Returns:</h5>

        


<dl class="param-type">
    <dt>
        Type
    </dt>
    <dd>
        
<span class="param-type"><a href="global.html#AdapterOption">AdapterOption</a></span>


    </dd>
</dl>

    



        
            

    

    <h4 class="name" id="._waitingJobStatus"><span class="type-signature">(async, static) </span>_waitingJobStatus<span class="signature">(timeout)</span><span class="type-signature"></span></h4>

    




<dl class="details">

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="index.js.html">index.js</a>, <a href="index.js.html#line979">line 979</a>
    </li></ul></dd>
    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    
</dl>





<div class="description usertext">
    <p>This internal function waits until all taskObj are resolved (having their own exit codes).</p>
</div>











    <h5>Parameters:</h5>
    

<table class="params">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        

        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>timeout</code></td>
            

            <td class="type">
            
                
<span class="param-type">*</span>


            
            </td>

            

            

            <td class="description last"></td>
        </tr>

    
    </tbody>
</table>



















        
            

    

    <h4 class="name" id="._writeTaskLogs"><span class="type-signature">(async, static) </span>_writeTaskLogs<span class="signature">(isFinished)</span><span class="type-signature"></span></h4>

    




<dl class="details">

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="index.js.html">index.js</a>, <a href="index.js.html#line734">line 734</a>
    </li></ul></dd>
    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    
</dl>















    <h5>Parameters:</h5>
    

<table class="params">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        

        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>isFinished</code></td>
            

            <td class="type">
            
                
<span class="param-type">*</span>


            
            </td>

            

            

            <td class="description last"><p>an indicator to specify whether the writing target is indexed.txt or planned-index.txt.
This async function is used for update the job running states.</p></td>
        </tr>

    
    </tbody>
</table>



















        
            

    

    <h4 class="name" id=".beforeExit"><span class="type-signature">(async, static) </span>beforeExit<span class="signature">()</span><span class="type-signature"></span></h4>

    




<dl class="details">

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="index.js.html">index.js</a>, <a href="index.js.html#line266">line 266</a>
    </li></ul></dd>
    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    
</dl>





<div class="description usertext">
    <p>An async function that cleanup all resources before exit this process.</p>
</div>




























        
            

    

    <h4 class="name" id=".beforeStart"><span class="type-signature">(async, static) </span>beforeStart<span class="signature">()</span><span class="type-signature"></span></h4>

    




<dl class="details">

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="index.js.html">index.js</a>, <a href="index.js.html#line248">line 248</a>
    </li></ul></dd>
    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    
</dl>





<div class="description usertext">
    <p>An async function that preparing all required resources to run tasks.</p>
</div>




























        
            

    

    <h4 class="name" id=".detectJobStatus"><span class="type-signature">(async, static) </span>detectJobStatus<span class="signature">()</span><span class="type-signature"></span></h4>

    




<dl class="details">

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="index.js.html">index.js</a>, <a href="index.js.html#line257">line 257</a>
    </li></ul></dd>
    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    
</dl>





<div class="description usertext">
    <p>Some Jobs may be sent to remote computing resources so the we cannot determine when does
the <code>this.runningTasks[taskID].taskEmitter</code> emit the finish or error event in the processSpawn function.
This <code>detectJobStatus</code> function can be implemented to check if the job is finished or has errors. Returns nothing.</p>
</div>




























        
            

    

    <h4 class="name" id=".initialize"><span class="type-signature">(static) </span>initialize<span class="signature">()</span><span class="type-signature"></span></h4>

    




<dl class="details">

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="index.js.html">index.js</a>, <a href="index.js.html#line1015">line 1015</a>
    </li></ul></dd>
    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    
</dl>





<div class="description usertext">
    <p>This function returns the exposed functions.</p>
</div>

























<h5>Returns:</h5>

        
<div class="param-desc">
    <p>An object that can be directly used by the developers. Used to run batch jobs.
Mandatory, Do NOT change unless necessary</p>
</div>



    



        
            

    

    <h4 class="name" id=".printStatus"><span class="type-signature">(static) </span>printStatus<span class="signature">(currentStatus)</span><span class="type-signature"></span></h4>

    




<dl class="details">

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="index.js.html">index.js</a>, <a href="index.js.html#line287">line 287</a>
    </li></ul></dd>
    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    
</dl>















    <h5>Parameters:</h5>
    

<table class="params">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        

        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>currentStatus</code></td>
            

            <td class="type">
            
                
<span class="param-type"><a href="global.html#BatchStatus">BatchStatus</a></span>


            
            </td>

            

            

            <td class="description last"><p>This function is used to print job progress in a batch task to stdout and stderr.</p></td>
        </tr>

    
    </tbody>
</table>



















        
            

    

    <h4 class="name" id=".processExitCallback"><span class="type-signature">(async, static) </span>processExitCallback<span class="signature">(taskID, exitCode, signal)</span><span class="type-signature"> &rarr; {processExit}</span></h4>

    




<dl class="details">

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="index.js.html">index.js</a>, <a href="index.js.html#line274">line 274</a>
    </li></ul></dd>
    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    
</dl>















    <h5>Parameters:</h5>
    

<table class="params">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        

        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>taskID</code></td>
            

            <td class="type">
            
                
<span class="param-type">string</span>


            
            </td>

            

            

            <td class="description last"><p>The task ID</p></td>
        </tr>

    

        <tr>
            
                <td class="name"><code>exitCode</code></td>
            

            <td class="type">
            
                
<span class="param-type">number</span>


            
            </td>

            

            

            <td class="description last"></td>
        </tr>

    

        <tr>
            
                <td class="name"><code>signal</code></td>
            

            <td class="type">
            
                
<span class="param-type">string</span>


            
            </td>

            

            

            <td class="description last"><p>The terminating signals such as SIGTERM, SIGINT if exists. For normal task execution, the signal will be <code>null</code>.</p></td>
        </tr>

    
    </tbody>
</table>
















<h5>Returns:</h5>

        
<div class="param-desc">
    <p>Process exit object, e.g. {exitCode: 0, signal: null}</p>
</div>



<dl class="param-type">
    <dt>
        Type
    </dt>
    <dd>
        
<span class="param-type">processExit</span>


    </dd>
</dl>

    



        
            

    

    <h4 class="name" id=".processSpawn"><span class="type-signature">(async, static) </span>processSpawn<span class="signature">(taskID)</span><span class="type-signature"> &rarr; {processRunning}</span></h4>

    




<dl class="details">

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="index.js.html">index.js</a>, <a href="index.js.html#line308">line 308</a>
    </li></ul></dd>
    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    
</dl>





<div class="description usertext">
    <p>Formuate the commands to spawn</p>
</div>











    <h5>Parameters:</h5>
    

<table class="params">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        

        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>taskID</code></td>
            

            <td class="type">
            
                
<span class="param-type">string</span>


            
            </td>

            

            

            <td class="description last"></td>
        </tr>

    
    </tbody>
</table>
















<h5>Returns:</h5>

        
<div class="param-desc">
    <p>a runningTaskObj that at least contains the taskEmitter that emits 'finished' or 'error'
Remember to update taskObj.command</p>
</div>



<dl class="param-type">
    <dt>
        Type
    </dt>
    <dd>
        
<span class="param-type">processRunning</span>


    </dd>
</dl>

    



        
            

    

    <h4 class="name" id=".taskOverrides"><span class="type-signature">(async, static) </span>taskOverrides<span class="signature">(taskObj, argumentRecipe)</span><span class="type-signature"> &rarr; {<a href="global.html#TaskDefinition">TaskDefinition</a>}</span></h4>

    




<dl class="details">

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="index.js.html">index.js</a>, <a href="index.js.html#line554">line 554</a>
    </li></ul></dd>
    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    
</dl>





<div class="description usertext">
    <p>Extends this function to overrides the task definitions.
Each extended adapter should override this function and use call super.taskOverrides(argumentRecipe)
if you use an argument-recipe yaml file to formulate your runtime arguments.
Also, developers need to change the TaskDefinition.option.mem to an accepted format. The TaskDefinition.option.mem is memory size in bytes.
Use the humanizeMemory filter function (@big-data-processor/utilities.memHumanize) to convert bytes into other human readable units, e.g. 1000000 to 1MB (or 1m); 1024 to 1KiB.</p>
</div>











    <h5>Parameters:</h5>
    

<table class="params">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        

        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>taskObj</code></td>
            

            <td class="type">
            
                
<span class="param-type"><a href="global.html#TaskDefinition">TaskDefinition</a></span>


            
            </td>

            

            

            <td class="description last"></td>
        </tr>

    

        <tr>
            
                <td class="name"><code>argumentRecipe</code></td>
            

            <td class="type">
            
                
<span class="param-type">string</span>


            
            </td>

            

            

            <td class="description last"><p>The recipe file path to transform the TaskDefinition.taskArgs into runtime arguments.</p></td>
        </tr>

    
    </tbody>
</table>
















<h5>Returns:</h5>

        


<dl class="param-type">
    <dt>
        Type
    </dt>
    <dd>
        
<span class="param-type"><a href="global.html#TaskDefinition">TaskDefinition</a></span>


    </dd>
</dl>

    



        
    

    

    
</article>

</section>







<section>

<header>
    
        <h2>
        BdpTaskAdapter
        </h2>
        
    
</header>

<article>
    
        <div class="container-overview">
        
            

    

    <h4 class="name" id="BdpTaskAdapter"><span class="type-signature"></span>new BdpTaskAdapter<span class="signature">(globalOption)</span><span class="type-signature"></span></h4>

    




<dl class="details">

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="index.js.html">index.js</a>, <a href="index.js.html#line155">line 155</a>
    </li></ul></dd>
    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    
</dl>





<div class="description usertext">
    <p>The constructor recieves the option object which contains information about the runtime settings. This global option will be overridden by task options.
The default behavior of this constructor prints the adapter name and authors.
Use globalOption.simplifiedTitle = true to specify a simplied title graph.
Feel free to change your style.</p>
</div>











    <h5>Parameters:</h5>
    

<table class="params">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        

        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>globalOption</code></td>
            

            <td class="type">
            
                
<span class="param-type"><a href="global.html#AdapterOption">AdapterOption</a></span>


            
            </td>

            

            

            <td class="description last"><p>An option object. See the _setOptions.js for more information.</p></td>
        </tr>

    
    </tbody>
</table>



















        
        </div>
    

    

    

    
    
    

     

    

    
        <h3 class="subsection-title">Members</h3>

        
            
<h4 class="name" id=".concurrencyDelayCount"><span class="type-signature">(static) </span>concurrencyDelayCount<span class="type-signature"> :number</span></h4>





<dl class="details">

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="index.js.html">index.js</a>, <a href="index.js.html#line164">line 164</a>
    </li></ul></dd>
    

    

    

    

    

    

    

    

    

    

    

    

    
    <dt class="tag-default">Default Value:</dt>
    <dd class="tag-default"><ul class="dummy">
            <li>1</li>
        </ul></dd>
    

    

    

    
</dl>





<div class="description usertext">
    <p>In case of setting a high concurrency number that causes submitting too many jobs at one time.
We added 1 to a delay count each time a job is sent. The job will be held for a delay interval times this delay count before it is processed.
In this way, even if there are so many jobs in a queue are submitted concurrently, the actual commands are delayed and processed one by one with the time interval.
Once a job is finished, there will be a small waiting time to determine whether the job submitting events are frequent.
If the event is not frequent, meaning that the <code>delayCount</code> remains the same after the waiting duration, the delayCount will be reset to 0.</p>
</div>



    <h5>Type:</h5>
    <ul>
        <li>
            
<span class="param-type">number</span>


        </li>
    </ul>






        
            
<h4 class="name" id=".delayInterval"><span class="type-signature">(static) </span>delayInterval<span class="type-signature"> :number</span></h4>





<dl class="details">

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="index.js.html">index.js</a>, <a href="index.js.html#line174">line 174</a>
    </li></ul></dd>
    

    

    

    

    

    

    

    

    

    

    

    

    
    <dt class="tag-default">Default Value:</dt>
    <dd class="tag-default"><ul class="dummy">
            <li>300</li>
        </ul></dd>
    

    

    

    
</dl>





<div class="description usertext">
    <p>This is a delay interval in milliseconds for concurrent job submission.
This prevents submitting too many jobs concurrently, especially when there are too many concurrent jobs to be submitted.
This can be set via options.</p>
</div>



    <h5>Type:</h5>
    <ul>
        <li>
            
<span class="param-type">number</span>


        </li>
    </ul>






        
            
<h4 class="name" id=".previousStatus"><span class="type-signature">(static) </span>previousStatus<span class="type-signature"> :<a href="global.html#BatchStatus">BatchStatus</a></span></h4>





<dl class="details">

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="index.js.html">index.js</a>, <a href="index.js.html#line184">line 184</a>
    </li></ul></dd>
    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    
</dl>





<div class="description usertext">
    <p>This object stores the progress of batch tasks.</p>
</div>



    <h5>Type:</h5>
    <ul>
        <li>
            
<span class="param-type"><a href="global.html#BatchStatus">BatchStatus</a></span>


        </li>
    </ul>






        
            
<h4 class="name" id=".queue"><span class="type-signature">(static) </span>queue<span class="type-signature"> :queue</span></h4>





<dl class="details">

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="index.js.html">index.js</a>, <a href="index.js.html#line198">line 198</a>
    </li></ul></dd>
    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    
</dl>





<div class="description usertext">
    <p>A queue object from https://www.npmjs.com/package/queue</p>
</div>



    <h5>Type:</h5>
    <ul>
        <li>
            
<span class="param-type">queue</span>


        </li>
    </ul>






        
            
<h4 class="name" id=".taskLogs"><span class="type-signature">(static) </span>taskLogs<span class="type-signature"> :Object.&lt;string, <a href="global.html#TaskDefinition">TaskDefinition</a>></span></h4>





<dl class="details">

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="index.js.html">index.js</a>, <a href="index.js.html#line158">line 158</a>
    </li></ul></dd>
    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    
</dl>





<div class="description usertext">
    <p>This is where</p>
</div>



    <h5>Type:</h5>
    <ul>
        <li>
            
<span class="param-type">Object.&lt;string, <a href="global.html#TaskDefinition">TaskDefinition</a>></span>


        </li>
    </ul>






        
    

    
        <h3 class="subsection-title">Methods</h3>

        
            

    

    <h4 class="name" id="._addTasks"><span class="type-signature">(async, static) </span>_addTasks<span class="signature">()</span><span class="type-signature"> &rarr; {Array.&lt;<a href="global.html#TaskDefinition">TaskDefinition</a>>}</span></h4>

    




<dl class="details">

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="index.js.html">index.js</a>, <a href="index.js.html#line571">line 571</a>
    </li></ul></dd>
    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    
</dl>





<div class="description usertext">
    <p>An async function that construct each task object in the this.taskLogs</p>
</div>

























<h5>Returns:</h5>

        
<div class="param-desc">
    <p>This process should fill the <code>this.taskLog</code> object with each process.</p>
</div>



<dl class="param-type">
    <dt>
        Type
    </dt>
    <dd>
        
<span class="param-type">Array.&lt;<a href="global.html#TaskDefinition">TaskDefinition</a>></span>


    </dd>
</dl>

    



        
            

    

    <h4 class="name" id="._checkStatus"><span class="type-signature">(async, static) </span>_checkStatus<span class="signature">()</span><span class="type-signature"> &rarr; {<a href="global.html#BatchStatus">BatchStatus</a>}</span></h4>

    




<dl class="details">

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="index.js.html">index.js</a>, <a href="index.js.html#line650">line 650</a>
    </li></ul></dd>
    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    
</dl>





<div class="description usertext">
    <p>This function checks job status and return the latest status object.
If finished/exited jobs detected, emit finish/error event on the this.runningTasks[jobID] eventEmitter.</p>
</div>

























<h5>Returns:</h5>

        
<div class="param-desc">
    <p>The updated batch status.</p>
</div>



<dl class="param-type">
    <dt>
        Type
    </dt>
    <dd>
        
<span class="param-type"><a href="global.html#BatchStatus">BatchStatus</a></span>


    </dd>
</dl>

    



        
            

    

    <h4 class="name" id="._loadProcessIndex"><span class="type-signature">(async, static) </span>_loadProcessIndex<span class="signature">()</span><span class="type-signature"></span></h4>

    




<dl class="details">

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="index.js.html">index.js</a>, <a href="index.js.html#line795">line 795</a>
    </li></ul></dd>
    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    
</dl>





<div class="description usertext">
    <p>This function loads the index.txt file in the <code>options.taskLogFolder</code> to check if jobs are finished with the <code>exitCode</code> of 0 (normal exit).
If the job is finished, then it is skipped. This is used for pipeline resuming if the running pipelines stop unexpectedly.</p>
</div>




























        
            

    

    <h4 class="name" id="._monitorTasks"><span class="type-signature">(async, static) </span>_monitorTasks<span class="signature">(queue)</span><span class="type-signature"></span></h4>

    




<dl class="details">

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="index.js.html">index.js</a>, <a href="index.js.html#line699">line 699</a>
    </li></ul></dd>
    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    
</dl>





<div class="description usertext">
    <p>This function is used to monitor job status and periodically checks job status.</p>
</div>











    <h5>Parameters:</h5>
    

<table class="params">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        

        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>queue</code></td>
            

            <td class="type">
            
            </td>

            

            

            <td class="description last"><p>The real queue object to deal the <code>this.runProcess</code> function of each job.</p></td>
        </tr>

    
    </tbody>
</table>



















        
            

    

    <h4 class="name" id="._parseRecipe"><span class="type-signature">(async, static) </span>_parseRecipe<span class="signature">(taskObj, argumentRecipe)</span><span class="type-signature"> &rarr; {<a href="global.html#TaskDefinition">TaskDefinition</a>}</span></h4>

    




<dl class="details">

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="index.js.html">index.js</a>, <a href="index.js.html#line506">line 506</a>
    </li></ul></dd>
    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    
</dl>





<div class="description usertext">
    <p>This function can be called inside BdpTaskAdapter.taskOverrides when you implement the taskOverrides function.
This function basically parses the recipe file (in yaml format) and overrides the TaskDefinition object. Then, it returns the updated object.
(Note: the original taskObj will be mutated.)</p>
</div>











    <h5>Parameters:</h5>
    

<table class="params">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        

        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>taskObj</code></td>
            

            <td class="type">
            
                
<span class="param-type"><a href="global.html#TaskDefinition">TaskDefinition</a></span>


            
            </td>

            

            

            <td class="description last"></td>
        </tr>

    

        <tr>
            
                <td class="name"><code>argumentRecipe</code></td>
            

            <td class="type">
            
                
<span class="param-type">string</span>


            
            </td>

            

            

            <td class="description last"><p>The recipe file path</p></td>
        </tr>

    
    </tbody>
</table>
















<h5>Returns:</h5>

        


<dl class="param-type">
    <dt>
        Type
    </dt>
    <dd>
        
<span class="param-type"><a href="global.html#TaskDefinition">TaskDefinition</a></span>


    </dd>
</dl>

    



        
            

    

    <h4 class="name" id="._processAfterExitCallback"><span class="type-signature">(async, static) </span>_processAfterExitCallback<span class="signature">(taskID, fileHandler)</span><span class="type-signature"></span></h4>

    




<dl class="details">

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="index.js.html">index.js</a>, <a href="index.js.html#line369">line 369</a>
    </li></ul></dd>
    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    
</dl>





<div class="description usertext">
    <p>This internal function is called after the <code>processExitCallback</code> function.
The default behavior is to store the resulting stdout/stderr files.</p>
</div>











    <h5>Parameters:</h5>
    

<table class="params">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        

        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>taskID</code></td>
            

            <td class="type">
            
                
<span class="param-type">string</span>


            
            </td>

            

            

            <td class="description last"></td>
        </tr>

    

        <tr>
            
                <td class="name"><code>fileHandler</code></td>
            

            <td class="type">
            
                
<span class="param-type"><a href="global.html#FileHandler">FileHandler</a></span>


            
            </td>

            

            

            <td class="description last"></td>
        </tr>

    
    </tbody>
</table>



















        
            

    

    <h4 class="name" id="._processBeforeExitCallback"><span class="type-signature">(async, static) </span>_processBeforeExitCallback<span class="signature">(taskID, fileHandler)</span><span class="type-signature"></span></h4>

    




<dl class="details">

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="index.js.html">index.js</a>, <a href="index.js.html#line325">line 325</a>
    </li></ul></dd>
    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    
</dl>





<div class="description usertext">
    <p>This internal function will be called right after a job has exited (finished or errored) and before the <code>processExitCallback</code> function.
The default behavior is to get the remaining stdout/stderr messages and clean up the streaming resources.</p>
</div>











    <h5>Parameters:</h5>
    

<table class="params">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        

        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>taskID</code></td>
            

            <td class="type">
            
                
<span class="param-type">string</span>


            
            </td>

            

            

            <td class="description last"></td>
        </tr>

    

        <tr>
            
                <td class="name"><code>fileHandler</code></td>
            

            <td class="type">
            
                
<span class="param-type"><a href="global.html#FileHandler">FileHandler</a></span>


            
            </td>

            

            

            <td class="description last"></td>
        </tr>

    
    </tbody>
</table>



















        
            

    

    <h4 class="name" id="._resumeRemoteTasks"><span class="type-signature">(async, static) </span>_resumeRemoteTasks<span class="signature">()</span><span class="type-signature"></span></h4>

    




<dl class="details">

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="index.js.html">index.js</a>, <a href="index.js.html#line843">line 843</a>
    </li></ul></dd>
    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    
</dl>





<div class="description usertext">
    <p>This function trying to fetch remote jobs.
This is perticularly useful when adapter process somehow closed and re-run the same adapter process.
Instead of directly re-creation of non-fnihsing jobs, adapter trys to fetch the job histroy.
Then, the adapter can see if there is a need to re-submit jobs.</p>
</div>




























        
            

    

    <h4 class="name" id="._runProcess"><span class="type-signature">(async, static) </span>_runProcess<span class="signature">(taskID)</span><span class="type-signature"> &rarr; {promise}</span></h4>

    




<dl class="details">

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="index.js.html">index.js</a>, <a href="index.js.html#line428">line 428</a>
    </li></ul></dd>
    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    
</dl>





<div class="description usertext">
    <p>An async function that used to run a single job.</p>
</div>











    <h5>Parameters:</h5>
    

<table class="params">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        

        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>taskID</code></td>
            

            <td class="type">
            
                
<span class="param-type">string</span>


            
            </td>

            

            

            <td class="description last"><p>The auto-generated and uniqe task ID</p></td>
        </tr>

    
    </tbody>
</table>
















<h5>Returns:</h5>

        
<div class="param-desc">
    <p>A promise object that will be resovled when the task is finished normally and will be rejected when the task has errors (exitCode !== 0) or leaves unexpectedly.</p>
</div>



<dl class="param-type">
    <dt>
        Type
    </dt>
    <dd>
        
<span class="param-type">promise</span>


    </dd>
</dl>

    



        
            

    

    <h4 class="name" id="._runTasks"><span class="type-signature">(async, static) </span>_runTasks<span class="signature">()</span><span class="type-signature"></span></h4>

    




<dl class="details">

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="index.js.html">index.js</a>, <a href="index.js.html#line901">line 901</a>
    </li></ul></dd>
    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    
</dl>





<div class="description usertext">
    <p>The core function to initiate the queue to process tasks.</p>
</div>




























        
            

    

    <h4 class="name" id="._setOptions"><span class="type-signature">(static) </span>_setOptions<span class="signature">(options)</span><span class="type-signature"> &rarr; {<a href="global.html#AdapterOption">AdapterOption</a>}</span></h4>

    




<dl class="details">

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="index.js.html">index.js</a>, <a href="index.js.html#line208">line 208</a>
    </li></ul></dd>
    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    
</dl>















    <h5>Parameters:</h5>
    

<table class="params">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        

        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>options</code></td>
            

            <td class="type">
            
                
<span class="param-type"><a href="global.html#AdapterOption">AdapterOption</a></span>


            
            </td>

            

            

            <td class="description last"></td>
        </tr>

    
    </tbody>
</table>
















<h5>Returns:</h5>

        


<dl class="param-type">
    <dt>
        Type
    </dt>
    <dd>
        
<span class="param-type"><a href="global.html#AdapterOption">AdapterOption</a></span>


    </dd>
</dl>

    



        
            

    

    <h4 class="name" id="._waitingJobStatus"><span class="type-signature">(async, static) </span>_waitingJobStatus<span class="signature">(timeout)</span><span class="type-signature"></span></h4>

    




<dl class="details">

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="index.js.html">index.js</a>, <a href="index.js.html#line979">line 979</a>
    </li></ul></dd>
    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    
</dl>





<div class="description usertext">
    <p>This internal function waits until all taskObj are resolved (having their own exit codes).</p>
</div>











    <h5>Parameters:</h5>
    

<table class="params">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        

        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>timeout</code></td>
            

            <td class="type">
            
                
<span class="param-type">*</span>


            
            </td>

            

            

            <td class="description last"></td>
        </tr>

    
    </tbody>
</table>



















        
            

    

    <h4 class="name" id="._writeTaskLogs"><span class="type-signature">(async, static) </span>_writeTaskLogs<span class="signature">(isFinished)</span><span class="type-signature"></span></h4>

    




<dl class="details">

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="index.js.html">index.js</a>, <a href="index.js.html#line734">line 734</a>
    </li></ul></dd>
    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    
</dl>















    <h5>Parameters:</h5>
    

<table class="params">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        

        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>isFinished</code></td>
            

            <td class="type">
            
                
<span class="param-type">*</span>


            
            </td>

            

            

            <td class="description last"><p>an indicator to specify whether the writing target is indexed.txt or planned-index.txt.
This async function is used for update the job running states.</p></td>
        </tr>

    
    </tbody>
</table>



















        
            

    

    <h4 class="name" id=".beforeExit"><span class="type-signature">(async, static) </span>beforeExit<span class="signature">()</span><span class="type-signature"></span></h4>

    




<dl class="details">

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="index.js.html">index.js</a>, <a href="index.js.html#line266">line 266</a>
    </li></ul></dd>
    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    
</dl>





<div class="description usertext">
    <p>An async function that cleanup all resources before exit this process.</p>
</div>




























        
            

    

    <h4 class="name" id=".beforeStart"><span class="type-signature">(async, static) </span>beforeStart<span class="signature">()</span><span class="type-signature"></span></h4>

    




<dl class="details">

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="index.js.html">index.js</a>, <a href="index.js.html#line248">line 248</a>
    </li></ul></dd>
    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    
</dl>





<div class="description usertext">
    <p>An async function that preparing all required resources to run tasks.</p>
</div>




























        
            

    

    <h4 class="name" id=".detectJobStatus"><span class="type-signature">(async, static) </span>detectJobStatus<span class="signature">()</span><span class="type-signature"></span></h4>

    




<dl class="details">

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="index.js.html">index.js</a>, <a href="index.js.html#line257">line 257</a>
    </li></ul></dd>
    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    
</dl>





<div class="description usertext">
    <p>Some Jobs may be sent to remote computing resources so the we cannot determine when does
the <code>this.runningTasks[taskID].taskEmitter</code> emit the finish or error event in the processSpawn function.
This <code>detectJobStatus</code> function can be implemented to check if the job is finished or has errors. Returns nothing.</p>
</div>




























        
            

    

    <h4 class="name" id=".initialize"><span class="type-signature">(static) </span>initialize<span class="signature">()</span><span class="type-signature"></span></h4>

    




<dl class="details">

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="index.js.html">index.js</a>, <a href="index.js.html#line1015">line 1015</a>
    </li></ul></dd>
    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    
</dl>





<div class="description usertext">
    <p>This function returns the exposed functions.</p>
</div>

























<h5>Returns:</h5>

        
<div class="param-desc">
    <p>An object that can be directly used by the developers. Used to run batch jobs.
Mandatory, Do NOT change unless necessary</p>
</div>



    



        
            

    

    <h4 class="name" id=".printStatus"><span class="type-signature">(static) </span>printStatus<span class="signature">(currentStatus)</span><span class="type-signature"></span></h4>

    




<dl class="details">

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="index.js.html">index.js</a>, <a href="index.js.html#line287">line 287</a>
    </li></ul></dd>
    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    
</dl>















    <h5>Parameters:</h5>
    

<table class="params">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        

        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>currentStatus</code></td>
            

            <td class="type">
            
                
<span class="param-type"><a href="global.html#BatchStatus">BatchStatus</a></span>


            
            </td>

            

            

            <td class="description last"><p>This function is used to print job progress in a batch task to stdout and stderr.</p></td>
        </tr>

    
    </tbody>
</table>



















        
            

    

    <h4 class="name" id=".processExitCallback"><span class="type-signature">(async, static) </span>processExitCallback<span class="signature">(taskID, exitCode, signal)</span><span class="type-signature"> &rarr; {processExit}</span></h4>

    




<dl class="details">

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="index.js.html">index.js</a>, <a href="index.js.html#line274">line 274</a>
    </li></ul></dd>
    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    
</dl>















    <h5>Parameters:</h5>
    

<table class="params">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        

        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>taskID</code></td>
            

            <td class="type">
            
                
<span class="param-type">string</span>


            
            </td>

            

            

            <td class="description last"><p>The task ID</p></td>
        </tr>

    

        <tr>
            
                <td class="name"><code>exitCode</code></td>
            

            <td class="type">
            
                
<span class="param-type">number</span>


            
            </td>

            

            

            <td class="description last"></td>
        </tr>

    

        <tr>
            
                <td class="name"><code>signal</code></td>
            

            <td class="type">
            
                
<span class="param-type">string</span>


            
            </td>

            

            

            <td class="description last"><p>The terminating signals such as SIGTERM, SIGINT if exists. For normal task execution, the signal will be <code>null</code>.</p></td>
        </tr>

    
    </tbody>
</table>
















<h5>Returns:</h5>

        
<div class="param-desc">
    <p>Process exit object, e.g. {exitCode: 0, signal: null}</p>
</div>



<dl class="param-type">
    <dt>
        Type
    </dt>
    <dd>
        
<span class="param-type">processExit</span>


    </dd>
</dl>

    



        
            

    

    <h4 class="name" id=".processSpawn"><span class="type-signature">(async, static) </span>processSpawn<span class="signature">(taskID)</span><span class="type-signature"> &rarr; {processRunning}</span></h4>

    




<dl class="details">

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="index.js.html">index.js</a>, <a href="index.js.html#line308">line 308</a>
    </li></ul></dd>
    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    
</dl>





<div class="description usertext">
    <p>Formuate the commands to spawn</p>
</div>











    <h5>Parameters:</h5>
    

<table class="params">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        

        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>taskID</code></td>
            

            <td class="type">
            
                
<span class="param-type">string</span>


            
            </td>

            

            

            <td class="description last"></td>
        </tr>

    
    </tbody>
</table>
















<h5>Returns:</h5>

        
<div class="param-desc">
    <p>a runningTaskObj that at least contains the taskEmitter that emits 'finished' or 'error'
Remember to update taskObj.command</p>
</div>



<dl class="param-type">
    <dt>
        Type
    </dt>
    <dd>
        
<span class="param-type">processRunning</span>


    </dd>
</dl>

    



        
            

    

    <h4 class="name" id=".taskOverrides"><span class="type-signature">(async, static) </span>taskOverrides<span class="signature">(taskObj, argumentRecipe)</span><span class="type-signature"> &rarr; {<a href="global.html#TaskDefinition">TaskDefinition</a>}</span></h4>

    




<dl class="details">

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="index.js.html">index.js</a>, <a href="index.js.html#line554">line 554</a>
    </li></ul></dd>
    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    
</dl>





<div class="description usertext">
    <p>Extends this function to overrides the task definitions.
Each extended adapter should override this function and use call super.taskOverrides(argumentRecipe)
if you use an argument-recipe yaml file to formulate your runtime arguments.
Also, developers need to change the TaskDefinition.option.mem to an accepted format. The TaskDefinition.option.mem is memory size in bytes.
Use the humanizeMemory filter function (@big-data-processor/utilities.memHumanize) to convert bytes into other human readable units, e.g. 1000000 to 1MB (or 1m); 1024 to 1KiB.</p>
</div>











    <h5>Parameters:</h5>
    

<table class="params">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        

        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>taskObj</code></td>
            

            <td class="type">
            
                
<span class="param-type"><a href="global.html#TaskDefinition">TaskDefinition</a></span>


            
            </td>

            

            

            <td class="description last"></td>
        </tr>

    

        <tr>
            
                <td class="name"><code>argumentRecipe</code></td>
            

            <td class="type">
            
                
<span class="param-type">string</span>


            
            </td>

            

            

            <td class="description last"><p>The recipe file path to transform the TaskDefinition.taskArgs into runtime arguments.</p></td>
        </tr>

    
    </tbody>
</table>
















<h5>Returns:</h5>

        


<dl class="param-type">
    <dt>
        Type
    </dt>
    <dd>
        
<span class="param-type"><a href="global.html#TaskDefinition">TaskDefinition</a></span>


    </dd>
</dl>

    



        
    

    

    
</article>

</section>




    
    
</div>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 3.6.5</a> on Fri Aug 28 2020 12:32:59 GMT+0800 (台北標準時間) using the <a href="https://github.com/clenemt/docdash">docdash</a> theme.
</footer>

<script>prettyPrint();</script>
<script src="scripts/polyfill.js"></script>
<script src="scripts/linenumber.js"></script>

<script src="scripts/search.js" defer></script>



</body>
</html>