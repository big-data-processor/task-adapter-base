<!DOCTYPE html>
<html lang="en">
<head>
    
    <meta charset="utf-8">
    <title>BdpTaskAdapter - Documentation</title>
    
    
    <script src="scripts/prettify/prettify.js"></script>
    <script src="scripts/prettify/lang-css.js"></script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc.css">
    <script src="scripts/nav.js" defer></script>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
</head>
<body>

<input type="checkbox" id="nav-trigger" class="nav-trigger" />
<label for="nav-trigger" class="navicon-button x">
  <div class="navicon"></div>
</label>

<label for="nav-trigger" class="overlay"></label>

<nav >
    
    <input type="text" id="nav-search" placeholder="Search" />
    
    <h2><a href="index.html">Home</a></h2><h2><a href="https://github.com/big-data-processor/task-adapter-base" target="_blank" class="menu-item" id="github-repo" >Github Repo</a></h2><h3>Classes</h3><ul><li><a href="BdpTaskAdapter.html">BdpTaskAdapter</a><ul class='methods'><li data-type='method'><a href="BdpTaskAdapter.html#emitJobStatus">emitJobStatus</a></li><li data-type='method'><a href="BdpTaskAdapter.html#getAllJobIds">getAllJobIds</a></li><li data-type='method'><a href="BdpTaskAdapter.html#getJobById">getJobById</a></li><li data-type='method'><a href="BdpTaskAdapter.html#initialize">initialize</a></li><li data-type='method'><a href="BdpTaskAdapter.html#parseRecipe">parseRecipe</a></li><li data-type='method'><a href="BdpTaskAdapter.html#~_addJobs">_addJobs</a></li><li data-type='method'><a href="BdpTaskAdapter.html#~_checkStatus">_checkStatus</a></li><li data-type='method'><a href="BdpTaskAdapter.html#~_handleProxy">_handleProxy</a></li><li data-type='method'><a href="BdpTaskAdapter.html#~_jobAfterExitCallback">_jobAfterExitCallback</a></li><li data-type='method'><a href="BdpTaskAdapter.html#~_jobBeforeExitCallback">_jobBeforeExitCallback</a></li><li data-type='method'><a href="BdpTaskAdapter.html#~_loadProgress">_loadProgress</a></li><li data-type='method'><a href="BdpTaskAdapter.html#~_monitorJobs">_monitorJobs</a></li><li data-type='method'><a href="BdpTaskAdapter.html#~_printStatus">_printStatus</a></li><li data-type='method'><a href="BdpTaskAdapter.html#~_resumeJobs">_resumeJobs</a></li><li data-type='method'><a href="BdpTaskAdapter.html#~_runJob">_runJob</a></li><li data-type='method'><a href="BdpTaskAdapter.html#~_runTasks">_runTasks</a></li><li data-type='method'><a href="BdpTaskAdapter.html#~_sendMsgToBdpClient">_sendMsgToBdpClient</a></li><li data-type='method'><a href="BdpTaskAdapter.html#~_waitingJobStatus">_waitingJobStatus</a></li><li data-type='method'><a href="BdpTaskAdapter.html#~_writeJobLogs">_writeJobLogs</a></li><li data-type='method'><a href="BdpTaskAdapter.html#~setOptions">setOptions</a></li></ul></li><li></li></ul><h3>Interfaces</h3><ul><li><a href="IAdapter.html">IAdapter</a><ul class='methods'><li data-type='method'><a href="IAdapter.html#beforeExit">beforeExit</a></li><li data-type='method'><a href="IAdapter.html#beforeStart">beforeStart</a></li><li data-type='method'><a href="IAdapter.html#detectJobStatus">detectJobStatus</a></li><li data-type='method'><a href="IAdapter.html#determineJobProxy">determineJobProxy</a></li><li data-type='method'><a href="IAdapter.html#jobExitCallback">jobExitCallback</a></li><li data-type='method'><a href="IAdapter.html#jobOverrides">jobOverrides</a></li><li data-type='method'><a href="IAdapter.html#jobSpawn">jobSpawn</a></li><li data-type='method'><a href="IAdapter.html#stopAllJobs">stopAllJobs</a></li></ul></li></ul><h3>Global</h3><ul><li><a href="global.html#AdapterOption">AdapterOption</a></li><li><a href="global.html#BatchStatus">BatchStatus</a></li><li><a href="global.html#FileHandler">FileHandler</a></li><li><a href="global.html#globalReadlineInterface">globalReadlineInterface</a></li><li><a href="global.html#JobDefinition">JobDefinition</a></li><li><a href="global.html#ProcessExit">ProcessExit</a></li><li><a href="global.html#Proxy">Proxy</a></li><li><a href="global.html#RunningJob">RunningJob</a></li><li><a href="global.html#TaskAdapterInstance">TaskAdapterInstance</a></li></ul>
</nav>

<div id="main">
    
    <h1 class="page-title">BdpTaskAdapter</h1>
    

    




<section>

<header>
    
        <h2>
        BdpTaskAdapter
        </h2>
        
    
</header>

<article>
    
        <div class="container-overview">
        
            

    

    <h4 class="name" id="BdpTaskAdapter"><span class="type-signature"></span>new BdpTaskAdapter<span class="signature">()</span><span class="type-signature"></span></h4>

    




<dl class="details">

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="index.js.html">index.js</a>, <a href="index.js.html#line255">line 255</a>
    </li></ul></dd>
    

    

    

    

    

    

    
    <dt class="implements">Implements:</dt>
    <dd class="implements"><ul>
        
            <li><a href="IAdapter.html">IAdapter</a></li>
        
    </ul></dd>
    

    

    

    
    <dt class="tag-author">Author:</dt>
    <dd class="tag-author">
        <ul>
            <li><a href="mailto:chiyang1118@gmail.com">Chi Yang</a></li>
        </ul>
    </dd>
    

    

    
    <dt class="tag-license">License:</dt>
    <dd class="tag-license"><ul class="dummy"><li>MIT LicensedCopyright (c) 2021 Chi Yang(楊崎) <chiyang1118@gmail.com>Permission is hereby granted, free of charge, to any person obtaining a copyof this software and associated documentation files (the "Software"), to dealin the Software without restriction, including without limitation the rightsto use, copy, modify, merge, publish, distribute, sublicense, and/or sellcopies of the Software, and to permit persons to whom the Software isfurnished to do so, subject to the following conditions:The above copyright notice and this permission notice shall be included in allcopies or substantial portions of the Software.THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS ORIMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THEAUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHERLIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THESOFTWARE.</li></ul></dd>
    

    

    

    

    
</dl>
































        
        </div>
    

    

    

    
    
    

     

    

    
        <h3 class="subsection-title">Members</h3>

        
            
<h4 class="name" id="~concurrencyDelayCount"><span class="type-signature">(inner) </span>concurrencyDelayCount<span class="type-signature"> :number</span></h4>





<dl class="details">

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="index.js.html">index.js</a>, <a href="index.js.html#line302">line 302</a>
    </li></ul></dd>
    

    

    

    

    

    

    

    

    

    

    

    

    
    <dt class="tag-default">Default Value:</dt>
    <dd class="tag-default"><ul class="dummy">
            <li>1</li>
        </ul></dd>
    

    

    

    
</dl>





<div class="description usertext">
    <p>In case of setting a high concurrency number that causes submitting too many jobs at one time.
We added 1 to a delay count each time a job is sent. The job will be held for a delay interval times this delay count before it is processed.
In this way, even if there are so many jobs in a queue are submitted concurrently, the actual commands are delayed and processed one by one with the time interval.
Once a job is finished, there will be a small waiting time to determine whether the job submitting events are frequent.
If the event is not frequent, meaning that the <code>delayCount</code> remains the same after the waiting duration, the delayCount will be reset to 0.</p>
</div>



    <h5>Type:</h5>
    <ul>
        <li>
            
<span class="param-type">number</span>


        </li>
    </ul>






        
            
<h4 class="name" id="~delayInterval"><span class="type-signature">(inner) </span>delayInterval<span class="type-signature"> :number</span></h4>





<dl class="details">

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="index.js.html">index.js</a>, <a href="index.js.html#line312">line 312</a>
    </li></ul></dd>
    

    

    

    

    

    

    

    

    

    

    

    

    
    <dt class="tag-default">Default Value:</dt>
    <dd class="tag-default"><ul class="dummy">
            <li>300</li>
        </ul></dd>
    

    

    

    
</dl>





<div class="description usertext">
    <p>This is a delay interval in milliseconds for concurrent job submission.
This prevents submitting too many jobs concurrently, especially when there are too many concurrent jobs to be submitted.
This can be set via options.</p>
</div>



    <h5>Type:</h5>
    <ul>
        <li>
            
<span class="param-type">number</span>


        </li>
    </ul>






        
            
<h4 class="name" id="~isStopping"><span class="type-signature">(inner, readonly) </span>isStopping<span class="type-signature"> :boolean</span></h4>





<dl class="details">

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="index.js.html">index.js</a>, <a href="index.js.html#line425">line 425</a>
    </li></ul></dd>
    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    
</dl>





<div class="description usertext">
    <p>Using this property to understand whether the adapter is stopping.
You may use it to prevent extra waiting in while loops.</p>
</div>



    <h5>Type:</h5>
    <ul>
        <li>
            
<span class="param-type">boolean</span>


        </li>
    </ul>






        
            
<h4 class="name" id="~previousStatus"><span class="type-signature">(inner) </span>previousStatus<span class="type-signature"> :<a href="global.html#BatchStatus">BatchStatus</a></span></h4>





<dl class="details">

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="index.js.html">index.js</a>, <a href="index.js.html#line322">line 322</a>
    </li></ul></dd>
    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    
</dl>





<div class="description usertext">
    <p>This object stores the progress of batch tasks.</p>
</div>



    <h5>Type:</h5>
    <ul>
        <li>
            
<span class="param-type"><a href="global.html#BatchStatus">BatchStatus</a></span>


        </li>
    </ul>






        
            
<h4 class="name" id="~queue"><span class="type-signature">(inner) </span>queue<span class="type-signature"> :queue</span></h4>





<dl class="details">

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="index.js.html">index.js</a>, <a href="index.js.html#line336">line 336</a>
    </li></ul></dd>
    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    
</dl>





<div class="description usertext">
    <p>A queue object from https://www.npmjs.com/package/queue</p>
</div>



    <h5>Type:</h5>
    <ul>
        <li>
            
<span class="param-type">queue</span>


        </li>
    </ul>






        
            
<h4 class="name" id="~taskLogs"><span class="type-signature">(inner) </span>taskLogs<span class="type-signature"> :Map.&lt;string, <a href="global.html#JobDefinition">JobDefinition</a>></span></h4>





<dl class="details">

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="index.js.html">index.js</a>, <a href="index.js.html#line295">line 295</a>
    </li></ul></dd>
    

    

    

    

    

    

    

    

    

    

    

    

    
    <dt class="tag-default">Default Value:</dt>
    <dd class="tag-default"><ul class="dummy">
            <li>{}</li>
        </ul></dd>
    

    

    

    
</dl>





<div class="description usertext">
    <p>This variable stores all the task objects.</p>
</div>



    <h5>Type:</h5>
    <ul>
        <li>
            
<span class="param-type">Map.&lt;string, <a href="global.html#JobDefinition">JobDefinition</a>></span>


        </li>
    </ul>






        
    

    
        <h3 class="subsection-title">Methods</h3>

        
            

    

    <h4 class="name" id="emitJobStatus"><span class="type-signature">(async) </span>emitJobStatus<span class="signature">(jobId, code, signal)</span><span class="type-signature"></span></h4>

    




<dl class="details">

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="index.js.html">index.js</a>, <a href="index.js.html#line474">line 474</a>
    </li></ul></dd>
    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    
</dl>





<div class="description usertext">
    <p>This function emits the 'finish' event when the job exit code is 0 or the 'error' event when else.
Note that calling this function does not stop the job process. This function only notify the adapter that the job is finished.</p>
</div>











    <h5>Parameters:</h5>
    

<table class="params">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        

        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>jobId</code></td>
            

            <td class="type">
            
                
<span class="param-type">*</span>


            
            </td>

            

            

            <td class="description last"><p>The job ID.</p></td>
        </tr>

    

        <tr>
            
                <td class="name"><code>code</code></td>
            

            <td class="type">
            
                
<span class="param-type">*</span>


            
            </td>

            

            

            <td class="description last"><p>The job exit code</p></td>
        </tr>

    

        <tr>
            
                <td class="name"><code>signal</code></td>
            

            <td class="type">
            
                
<span class="param-type">*</span>


            
            </td>

            

            

            <td class="description last"><p>(optional) The job exit signal.</p></td>
        </tr>

    
    </tbody>
</table>



















        
            

    

    <h4 class="name" id="getAllJobIds"><span class="type-signature"></span>getAllJobIds<span class="signature">()</span><span class="type-signature"> &rarr; {Array.&lt;string>}</span></h4>

    




<dl class="details">

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="index.js.html">index.js</a>, <a href="index.js.html#line509">line 509</a>
    </li></ul></dd>
    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    
</dl>





<div class="description usertext">
    <p>This function returns all jobIds.</p>
</div>

























<h5>Returns:</h5>

        
<div class="param-desc">
    <p>Returns all job Ids.</p>
</div>



<dl class="param-type">
    <dt>
        Type
    </dt>
    <dd>
        
<span class="param-type">Array.&lt;string></span>


    </dd>
</dl>

    



        
            

    

    <h4 class="name" id="getJobById"><span class="type-signature"></span>getJobById<span class="signature">(jobId)</span><span class="type-signature"> &rarr; {<a href="global.html#JobDefinition">JobDefinition</a>}</span></h4>

    




<dl class="details">

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="index.js.html">index.js</a>, <a href="index.js.html#line499">line 499</a>
    </li></ul></dd>
    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    
</dl>





<div class="description usertext">
    <p>This function returns the job definition object by giving the corresponding jobId.</p>
</div>











    <h5>Parameters:</h5>
    

<table class="params">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        

        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>jobId</code></td>
            

            <td class="type">
            
                
<span class="param-type">*</span>


            
            </td>

            

            

            <td class="description last"><p>The job id</p></td>
        </tr>

    
    </tbody>
</table>
















<h5>Returns:</h5>

        
<div class="param-desc">
    <p>Returns the job definition object.</p>
</div>



<dl class="param-type">
    <dt>
        Type
    </dt>
    <dd>
        
<span class="param-type"><a href="global.html#JobDefinition">JobDefinition</a></span>


    </dd>
</dl>

    



        
            

    

    <h4 class="name" id="initialize"><span class="type-signature"></span>initialize<span class="signature">()</span><span class="type-signature"> &rarr; {<a href="global.html#TaskAdapterInstance">TaskAdapterInstance</a>}</span></h4>

    




<dl class="details">

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="index.js.html">index.js</a>, <a href="index.js.html#line1287">line 1287</a>
    </li></ul></dd>
    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    
</dl>





<div class="description usertext">
    <p>This function initializes the whole adapter process and must be called to get the Adapter object instance.</p>
</div>

























<h5>Returns:</h5>

        
<div class="param-desc">
    <p>An object that can be directly used by the developers. Used to run batch jobs.</p>
</div>



<dl class="param-type">
    <dt>
        Type
    </dt>
    <dd>
        
<span class="param-type"><a href="global.html#TaskAdapterInstance">TaskAdapterInstance</a></span>


    </dd>
</dl>

    



        
            

    

    <h4 class="name" id="parseRecipe"><span class="type-signature">(async) </span>parseRecipe<span class="signature">(jobObj, argumentRecipe)</span><span class="type-signature"> &rarr; {<a href="global.html#JobDefinition">JobDefinition</a>}</span></h4>

    




<dl class="details">

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="index.js.html">index.js</a>, <a href="index.js.html#line711">line 711</a>
    </li></ul></dd>
    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    
</dl>





<div class="description usertext">
    <p>This function can be called inside BdpTaskAdapter.jobOverrides when you implement the jobOverrides function.
This function basically parses the recipe file (in yaml format) and overrides the JobDefinition object. Then, it returns the updated job object.
(Note: the original job object will be mutated.)</p>
</div>











    <h5>Parameters:</h5>
    

<table class="params">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        

        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>jobObj</code></td>
            

            <td class="type">
            
                
<span class="param-type"><a href="global.html#JobDefinition">JobDefinition</a></span>


            
            </td>

            

            

            <td class="description last"><p>The job object</p></td>
        </tr>

    

        <tr>
            
                <td class="name"><code>argumentRecipe</code></td>
            

            <td class="type">
            
                
<span class="param-type">string</span>


            
            </td>

            

            

            <td class="description last"><p>The recipe file path</p></td>
        </tr>

    
    </tbody>
</table>
















<h5>Returns:</h5>

        


<dl class="param-type">
    <dt>
        Type
    </dt>
    <dd>
        
<span class="param-type"><a href="global.html#JobDefinition">JobDefinition</a></span>


    </dd>
</dl>

    



        
            

    

    <h4 class="name" id="~_addJobs"><span class="type-signature">(async, private, inner) </span>_addJobs<span class="signature">()</span><span class="type-signature"> &rarr; {Array.&lt;<a href="global.html#JobDefinition">JobDefinition</a>>}</span></h4>

    




<dl class="details">

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="index.js.html">index.js</a>, <a href="index.js.html#line758">line 758</a>
    </li></ul></dd>
    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    
</dl>





<div class="description usertext">
    <p>An async function that construct each task object in the this.jobStore</p>
</div>

























<h5>Returns:</h5>

        
<div class="param-desc">
    <p>This process should fill the <code>this.taskLog</code> object with each process.</p>
</div>



<dl class="param-type">
    <dt>
        Type
    </dt>
    <dd>
        
<span class="param-type">Array.&lt;<a href="global.html#JobDefinition">JobDefinition</a>></span>


    </dd>
</dl>

    



        
            

    

    <h4 class="name" id="~_checkStatus"><span class="type-signature">(async, private, inner) </span>_checkStatus<span class="signature">()</span><span class="type-signature"> &rarr; {<a href="global.html#BatchStatus">BatchStatus</a>}</span></h4>

    




<dl class="details">

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="index.js.html">index.js</a>, <a href="index.js.html#line858">line 858</a>
    </li></ul></dd>
    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    
</dl>





<div class="description usertext">
    <p>This function checks job status and return the latest status object.
If finished/exited jobs detected, emit finish/error event on the this.runningJobs[jobID] eventEmitter.</p>
</div>

























<h5>Returns:</h5>

        
<div class="param-desc">
    <p>The updated batch status.</p>
</div>



<dl class="param-type">
    <dt>
        Type
    </dt>
    <dd>
        
<span class="param-type"><a href="global.html#BatchStatus">BatchStatus</a></span>


    </dd>
</dl>

    



        
            

    

    <h4 class="name" id="~_handleProxy"><span class="type-signature">(private, inner) </span>_handleProxy<span class="signature">(jobId, Proxy)</span><span class="type-signature"></span></h4>

    




<dl class="details">

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="index.js.html">index.js</a>, <a href="index.js.html#line446">line 446</a>
    </li></ul></dd>
    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    
</dl>





<div class="description usertext">
    <p>This private funciton handles the proxy registration and unregistration.</p>
</div>











    <h5>Parameters:</h5>
    

<table class="params">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        

        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>jobId</code></td>
            

            <td class="type">
            
                
<span class="param-type">string</span>


            
            </td>

            

            

            <td class="description last"><p>The job ID</p></td>
        </tr>

    

        <tr>
            
                <td class="name"><code>Proxy</code></td>
            

            <td class="type">
            
                
<span class="param-type"><a href="global.html#Proxy">Proxy</a></span>


            
            </td>

            

            

            <td class="description last"><p>(Optional) The proxy object to register. When not giving this proxy, this function unregisters the proxy.</p></td>
        </tr>

    
    </tbody>
</table>



















        
            

    

    <h4 class="name" id="~_jobAfterExitCallback"><span class="type-signature">(async, private, inner) </span>_jobAfterExitCallback<span class="signature">(jobId, fileHandler)</span><span class="type-signature"></span></h4>

    




<dl class="details">

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="index.js.html">index.js</a>, <a href="index.js.html#line582">line 582</a>
    </li></ul></dd>
    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    
</dl>





<div class="description usertext">
    <p>This internal function is called after the <code>jobExitCallback</code> function.
This function stores the resulting stdout/stderr files and updates the status of all jobs.</p>
</div>











    <h5>Parameters:</h5>
    

<table class="params">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        

        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>jobId</code></td>
            

            <td class="type">
            
                
<span class="param-type">string</span>


            
            </td>

            

            

            <td class="description last"></td>
        </tr>

    

        <tr>
            
                <td class="name"><code>fileHandler</code></td>
            

            <td class="type">
            
                
<span class="param-type"><a href="global.html#FileHandler">FileHandler</a></span>


            
            </td>

            

            

            <td class="description last"></td>
        </tr>

    
    </tbody>
</table>



















        
            

    

    <h4 class="name" id="~_jobBeforeExitCallback"><span class="type-signature">(async, private, inner) </span>_jobBeforeExitCallback<span class="signature">(jobId, fileHandler)</span><span class="type-signature"></span></h4>

    




<dl class="details">

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="index.js.html">index.js</a>, <a href="index.js.html#line513">line 513</a>
    </li></ul></dd>
    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    
</dl>





<div class="description usertext">
    <p>This internal function will be called right after a job has exited (finished or errored) and before the <code>jobExitCallback</code> function.
The function gets the remaining stdout/stderr messages, cleans up the streaming resources and unregisters the proxy.</p>
</div>











    <h5>Parameters:</h5>
    

<table class="params">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        

        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>jobId</code></td>
            

            <td class="type">
            
                
<span class="param-type">string</span>


            
            </td>

            

            

            <td class="description last"></td>
        </tr>

    

        <tr>
            
                <td class="name"><code>fileHandler</code></td>
            

            <td class="type">
            
                
<span class="param-type"><a href="global.html#FileHandler">FileHandler</a></span>


            
            </td>

            

            

            <td class="description last"></td>
        </tr>

    
    </tbody>
</table>



















        
            

    

    <h4 class="name" id="~_loadProgress"><span class="type-signature">(async, private, inner) </span>_loadProgress<span class="signature">()</span><span class="type-signature"></span></h4>

    




<dl class="details">

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="index.js.html">index.js</a>, <a href="index.js.html#line1012">line 1012</a>
    </li></ul></dd>
    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    
</dl>





<div class="description usertext">
    <p>This function loads the index.txt file in the <code>options.taskLogFolder</code> to check if jobs are finished with the <code>exitCode</code> of 0 (normal exit).
If the job is finished, then it is skipped. This is used for pipeline resuming if the running pipelines stop unexpectedly.</p>
</div>




























        
            

    

    <h4 class="name" id="~_monitorJobs"><span class="type-signature">(async, private, inner) </span>_monitorJobs<span class="signature">(queue)</span><span class="type-signature"></span></h4>

    




<dl class="details">

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="index.js.html">index.js</a>, <a href="index.js.html#line913">line 913</a>
    </li></ul></dd>
    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    
</dl>





<div class="description usertext">
    <p>This function is used to monitor job status and periodically checks job status.</p>
</div>











    <h5>Parameters:</h5>
    

<table class="params">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        

        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>queue</code></td>
            

            <td class="type">
            
            </td>

            

            

            <td class="description last"><p>The real queue object to deal the <code>this.runProcess</code> function of each job.</p></td>
        </tr>

    
    </tbody>
</table>



















        
            

    

    <h4 class="name" id="~_printStatus"><span class="type-signature">(inner) </span>_printStatus<span class="signature">(currentStatus)</span><span class="type-signature"></span></h4>

    




<dl class="details">

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="index.js.html">index.js</a>, <a href="index.js.html#line389">line 389</a>
    </li></ul></dd>
    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    
</dl>















    <h5>Parameters:</h5>
    

<table class="params">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        

        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>currentStatus</code></td>
            

            <td class="type">
            
                
<span class="param-type"><a href="global.html#BatchStatus">BatchStatus</a></span>


            
            </td>

            

            

            <td class="description last"><p>The current status object with the fields {pending, queued, running, finishing, exit, done, total};
This function is used to print job progress in a batch task to stdout and stderr. You may customize this function for your prferred style.</p></td>
        </tr>

    
    </tbody>
</table>



















        
            

    

    <h4 class="name" id="~_resumeJobs"><span class="type-signature">(async, private, inner) </span>_resumeJobs<span class="signature">()</span><span class="type-signature"></span></h4>

    




<dl class="details">

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="index.js.html">index.js</a>, <a href="index.js.html#line1062">line 1062</a>
    </li></ul></dd>
    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    
</dl>





<div class="description usertext">
    <p>This function trying to fetch remote jobs.
This is perticularly useful when adapter process somehow closed and re-run the same adapter process.
Instead of directly re-creation of non-fnihsing jobs, adapter trys to fetch the job histroy.
Then, the adapter can see if there is a need to re-submit jobs.</p>
</div>




























        
            

    

    <h4 class="name" id="~_runJob"><span class="type-signature">(async, private, inner) </span>_runJob<span class="signature">(jobId)</span><span class="type-signature"> &rarr; {promise}</span></h4>

    




<dl class="details">

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="index.js.html">index.js</a>, <a href="index.js.html#line612">line 612</a>
    </li></ul></dd>
    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    
</dl>





<div class="description usertext">
    <p>An async function that used to run a single job.</p>
</div>











    <h5>Parameters:</h5>
    

<table class="params">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        

        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>jobId</code></td>
            

            <td class="type">
            
                
<span class="param-type">string</span>


            
            </td>

            

            

            <td class="description last"><p>The auto-generated and uniqe job ID</p></td>
        </tr>

    
    </tbody>
</table>
















<h5>Returns:</h5>

        
<div class="param-desc">
    <p>A promise object that will be resovled when the task is finished normally and will be rejected when the task has errors (exitCode !== 0) or leaves unexpectedly.</p>
</div>



<dl class="param-type">
    <dt>
        Type
    </dt>
    <dd>
        
<span class="param-type">promise</span>


    </dd>
</dl>

    



        
            

    

    <h4 class="name" id="~_runTasks"><span class="type-signature">(async, private, inner) </span>_runTasks<span class="signature">()</span><span class="type-signature"></span></h4>

    




<dl class="details">

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="index.js.html">index.js</a>, <a href="index.js.html#line1143">line 1143</a>
    </li></ul></dd>
    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    
</dl>





<div class="description usertext">
    <p>The core function to initiate the queue to process tasks.</p>
</div>




























        
            

    

    <h4 class="name" id="~_sendMsgToBdpClient"><span class="type-signature">(private, inner) </span>_sendMsgToBdpClient<span class="signature">(action, content)</span><span class="type-signature"></span></h4>

    




<dl class="details">

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="index.js.html">index.js</a>, <a href="index.js.html#line435">line 435</a>
    </li></ul></dd>
    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    
</dl>





<div class="description usertext">
    <p>This private function sends messages to bdp-server with process.send.</p>
</div>











    <h5>Parameters:</h5>
    

<table class="params">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        

        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>action</code></td>
            

            <td class="type">
            
                
<span class="param-type">string</span>


            
            </td>

            

            

            <td class="description last"><p>The message action type. The current possible values are 'registerProxy' or 'unregisterProxy'.</p></td>
        </tr>

    

        <tr>
            
                <td class="name"><code>content</code></td>
            

            <td class="type">
            
                
<span class="param-type">object</span>


            
            </td>

            

            

            <td class="description last"><p>The message content object of any types.</p></td>
        </tr>

    
    </tbody>
</table>



















        
            

    

    <h4 class="name" id="~_waitingJobStatus"><span class="type-signature">(async, private, inner) </span>_waitingJobStatus<span class="signature">(timeout)</span><span class="type-signature"></span></h4>

    




<dl class="details">

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="index.js.html">index.js</a>, <a href="index.js.html#line1250">line 1250</a>
    </li></ul></dd>
    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    
</dl>





<div class="description usertext">
    <p>This internal function waits until all job object are resolved (having their own exit codes).</p>
</div>











    <h5>Parameters:</h5>
    

<table class="params">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        

        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>timeout</code></td>
            

            <td class="type">
            
                
<span class="param-type">*</span>


            
            </td>

            

            

            <td class="description last"></td>
        </tr>

    
    </tbody>
</table>



















        
            

    

    <h4 class="name" id="~_writeJobLogs"><span class="type-signature">(async, private, inner) </span>_writeJobLogs<span class="signature">()</span><span class="type-signature"></span></h4>

    




<dl class="details">

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="index.js.html">index.js</a>, <a href="index.js.html#line950">line 950</a>
    </li></ul></dd>
    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    
</dl>





<div class="description usertext">
    <p>Writing task progress to the the <code>progress-index.txt</code> file</p>
</div>




























        
            

    

    <h4 class="name" id="~setOptions"><span class="type-signature">(inner) </span>setOptions<span class="signature">(options)</span><span class="type-signature"> &rarr; {<a href="global.html#AdapterOption">AdapterOption</a>}</span></h4>

    




<dl class="details">

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="index.js.html">index.js</a>, <a href="index.js.html#line346">line 346</a>
    </li></ul></dd>
    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    
</dl>





<div class="description usertext">
    <p>You may using this in your adapter class, such as <code>super._setOptions(options)</code>.</p>
</div>











    <h5>Parameters:</h5>
    

<table class="params">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        

        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>options</code></td>
            

            <td class="type">
            
                
<span class="param-type"><a href="global.html#AdapterOption">AdapterOption</a></span>


            
            </td>

            

            

            <td class="description last"></td>
        </tr>

    
    </tbody>
</table>
















<h5>Returns:</h5>

        


<dl class="param-type">
    <dt>
        Type
    </dt>
    <dd>
        
<span class="param-type"><a href="global.html#AdapterOption">AdapterOption</a></span>


    </dd>
</dl>

    



        
    

    

    
</article>

</section>







<section>

<header>
    
        <h2>
        BdpTaskAdapter
        </h2>
        
    
</header>

<article>
    
        <div class="container-overview">
        
            

    

    <h4 class="name" id="BdpTaskAdapter"><span class="type-signature"></span>new BdpTaskAdapter<span class="signature">(globalOption)</span><span class="type-signature"></span></h4>

    




<dl class="details">

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="index.js.html">index.js</a>, <a href="index.js.html#line291">line 291</a>
    </li></ul></dd>
    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    
</dl>





<div class="description usertext">
    <p>The constructor recieves the option object which contains information about the runtime settings. This global option will be overridden by task options.
The default behavior of this constructor prints the adapter name and authors.
Use globalOption.simplifiedTitle = true to specify a simplied title graph.
Feel free to change your style.</p>
</div>











    <h5>Parameters:</h5>
    

<table class="params">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        

        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>globalOption</code></td>
            

            <td class="type">
            
                
<span class="param-type"><a href="global.html#AdapterOption">AdapterOption</a></span>


            
            </td>

            

            

            <td class="description last"><p>An option object. See the setOptions for more information.</p></td>
        </tr>

    
    </tbody>
</table>



















        
        </div>
    

    

    

    
    
    

     

    

    
        <h3 class="subsection-title">Members</h3>

        
            
<h4 class="name" id="~concurrencyDelayCount"><span class="type-signature">(inner) </span>concurrencyDelayCount<span class="type-signature"> :number</span></h4>





<dl class="details">

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="index.js.html">index.js</a>, <a href="index.js.html#line302">line 302</a>
    </li></ul></dd>
    

    

    

    

    

    

    

    

    

    

    

    

    
    <dt class="tag-default">Default Value:</dt>
    <dd class="tag-default"><ul class="dummy">
            <li>1</li>
        </ul></dd>
    

    

    

    
</dl>





<div class="description usertext">
    <p>In case of setting a high concurrency number that causes submitting too many jobs at one time.
We added 1 to a delay count each time a job is sent. The job will be held for a delay interval times this delay count before it is processed.
In this way, even if there are so many jobs in a queue are submitted concurrently, the actual commands are delayed and processed one by one with the time interval.
Once a job is finished, there will be a small waiting time to determine whether the job submitting events are frequent.
If the event is not frequent, meaning that the <code>delayCount</code> remains the same after the waiting duration, the delayCount will be reset to 0.</p>
</div>



    <h5>Type:</h5>
    <ul>
        <li>
            
<span class="param-type">number</span>


        </li>
    </ul>






        
            
<h4 class="name" id="~delayInterval"><span class="type-signature">(inner) </span>delayInterval<span class="type-signature"> :number</span></h4>





<dl class="details">

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="index.js.html">index.js</a>, <a href="index.js.html#line312">line 312</a>
    </li></ul></dd>
    

    

    

    

    

    

    

    

    

    

    

    

    
    <dt class="tag-default">Default Value:</dt>
    <dd class="tag-default"><ul class="dummy">
            <li>300</li>
        </ul></dd>
    

    

    

    
</dl>





<div class="description usertext">
    <p>This is a delay interval in milliseconds for concurrent job submission.
This prevents submitting too many jobs concurrently, especially when there are too many concurrent jobs to be submitted.
This can be set via options.</p>
</div>



    <h5>Type:</h5>
    <ul>
        <li>
            
<span class="param-type">number</span>


        </li>
    </ul>






        
            
<h4 class="name" id="~isStopping"><span class="type-signature">(inner, readonly) </span>isStopping<span class="type-signature"> :boolean</span></h4>





<dl class="details">

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="index.js.html">index.js</a>, <a href="index.js.html#line425">line 425</a>
    </li></ul></dd>
    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    
</dl>





<div class="description usertext">
    <p>Using this property to understand whether the adapter is stopping.
You may use it to prevent extra waiting in while loops.</p>
</div>



    <h5>Type:</h5>
    <ul>
        <li>
            
<span class="param-type">boolean</span>


        </li>
    </ul>






        
            
<h4 class="name" id="~previousStatus"><span class="type-signature">(inner) </span>previousStatus<span class="type-signature"> :<a href="global.html#BatchStatus">BatchStatus</a></span></h4>





<dl class="details">

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="index.js.html">index.js</a>, <a href="index.js.html#line322">line 322</a>
    </li></ul></dd>
    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    
</dl>





<div class="description usertext">
    <p>This object stores the progress of batch tasks.</p>
</div>



    <h5>Type:</h5>
    <ul>
        <li>
            
<span class="param-type"><a href="global.html#BatchStatus">BatchStatus</a></span>


        </li>
    </ul>






        
            
<h4 class="name" id="~queue"><span class="type-signature">(inner) </span>queue<span class="type-signature"> :queue</span></h4>





<dl class="details">

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="index.js.html">index.js</a>, <a href="index.js.html#line336">line 336</a>
    </li></ul></dd>
    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    
</dl>





<div class="description usertext">
    <p>A queue object from https://www.npmjs.com/package/queue</p>
</div>



    <h5>Type:</h5>
    <ul>
        <li>
            
<span class="param-type">queue</span>


        </li>
    </ul>






        
            
<h4 class="name" id="~taskLogs"><span class="type-signature">(inner) </span>taskLogs<span class="type-signature"> :Map.&lt;string, <a href="global.html#JobDefinition">JobDefinition</a>></span></h4>





<dl class="details">

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="index.js.html">index.js</a>, <a href="index.js.html#line295">line 295</a>
    </li></ul></dd>
    

    

    

    

    

    

    

    

    

    

    

    

    
    <dt class="tag-default">Default Value:</dt>
    <dd class="tag-default"><ul class="dummy">
            <li>{}</li>
        </ul></dd>
    

    

    

    
</dl>





<div class="description usertext">
    <p>This variable stores all the task objects.</p>
</div>



    <h5>Type:</h5>
    <ul>
        <li>
            
<span class="param-type">Map.&lt;string, <a href="global.html#JobDefinition">JobDefinition</a>></span>


        </li>
    </ul>






        
    

    
        <h3 class="subsection-title">Methods</h3>

        
            

    

    <h4 class="name" id="emitJobStatus"><span class="type-signature">(async) </span>emitJobStatus<span class="signature">(jobId, code, signal)</span><span class="type-signature"></span></h4>

    




<dl class="details">

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="index.js.html">index.js</a>, <a href="index.js.html#line474">line 474</a>
    </li></ul></dd>
    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    
</dl>





<div class="description usertext">
    <p>This function emits the 'finish' event when the job exit code is 0 or the 'error' event when else.
Note that calling this function does not stop the job process. This function only notify the adapter that the job is finished.</p>
</div>











    <h5>Parameters:</h5>
    

<table class="params">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        

        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>jobId</code></td>
            

            <td class="type">
            
                
<span class="param-type">*</span>


            
            </td>

            

            

            <td class="description last"><p>The job ID.</p></td>
        </tr>

    

        <tr>
            
                <td class="name"><code>code</code></td>
            

            <td class="type">
            
                
<span class="param-type">*</span>


            
            </td>

            

            

            <td class="description last"><p>The job exit code</p></td>
        </tr>

    

        <tr>
            
                <td class="name"><code>signal</code></td>
            

            <td class="type">
            
                
<span class="param-type">*</span>


            
            </td>

            

            

            <td class="description last"><p>(optional) The job exit signal.</p></td>
        </tr>

    
    </tbody>
</table>



















        
            

    

    <h4 class="name" id="getAllJobIds"><span class="type-signature"></span>getAllJobIds<span class="signature">()</span><span class="type-signature"> &rarr; {Array.&lt;string>}</span></h4>

    




<dl class="details">

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="index.js.html">index.js</a>, <a href="index.js.html#line509">line 509</a>
    </li></ul></dd>
    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    
</dl>





<div class="description usertext">
    <p>This function returns all jobIds.</p>
</div>

























<h5>Returns:</h5>

        
<div class="param-desc">
    <p>Returns all job Ids.</p>
</div>



<dl class="param-type">
    <dt>
        Type
    </dt>
    <dd>
        
<span class="param-type">Array.&lt;string></span>


    </dd>
</dl>

    



        
            

    

    <h4 class="name" id="getJobById"><span class="type-signature"></span>getJobById<span class="signature">(jobId)</span><span class="type-signature"> &rarr; {<a href="global.html#JobDefinition">JobDefinition</a>}</span></h4>

    




<dl class="details">

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="index.js.html">index.js</a>, <a href="index.js.html#line499">line 499</a>
    </li></ul></dd>
    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    
</dl>





<div class="description usertext">
    <p>This function returns the job definition object by giving the corresponding jobId.</p>
</div>











    <h5>Parameters:</h5>
    

<table class="params">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        

        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>jobId</code></td>
            

            <td class="type">
            
                
<span class="param-type">*</span>


            
            </td>

            

            

            <td class="description last"><p>The job id</p></td>
        </tr>

    
    </tbody>
</table>
















<h5>Returns:</h5>

        
<div class="param-desc">
    <p>Returns the job definition object.</p>
</div>



<dl class="param-type">
    <dt>
        Type
    </dt>
    <dd>
        
<span class="param-type"><a href="global.html#JobDefinition">JobDefinition</a></span>


    </dd>
</dl>

    



        
            

    

    <h4 class="name" id="initialize"><span class="type-signature"></span>initialize<span class="signature">()</span><span class="type-signature"> &rarr; {<a href="global.html#TaskAdapterInstance">TaskAdapterInstance</a>}</span></h4>

    




<dl class="details">

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="index.js.html">index.js</a>, <a href="index.js.html#line1287">line 1287</a>
    </li></ul></dd>
    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    
</dl>





<div class="description usertext">
    <p>This function initializes the whole adapter process and must be called to get the Adapter object instance.</p>
</div>

























<h5>Returns:</h5>

        
<div class="param-desc">
    <p>An object that can be directly used by the developers. Used to run batch jobs.</p>
</div>



<dl class="param-type">
    <dt>
        Type
    </dt>
    <dd>
        
<span class="param-type"><a href="global.html#TaskAdapterInstance">TaskAdapterInstance</a></span>


    </dd>
</dl>

    



        
            

    

    <h4 class="name" id="parseRecipe"><span class="type-signature">(async) </span>parseRecipe<span class="signature">(jobObj, argumentRecipe)</span><span class="type-signature"> &rarr; {<a href="global.html#JobDefinition">JobDefinition</a>}</span></h4>

    




<dl class="details">

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="index.js.html">index.js</a>, <a href="index.js.html#line711">line 711</a>
    </li></ul></dd>
    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    
</dl>





<div class="description usertext">
    <p>This function can be called inside BdpTaskAdapter.jobOverrides when you implement the jobOverrides function.
This function basically parses the recipe file (in yaml format) and overrides the JobDefinition object. Then, it returns the updated job object.
(Note: the original job object will be mutated.)</p>
</div>











    <h5>Parameters:</h5>
    

<table class="params">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        

        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>jobObj</code></td>
            

            <td class="type">
            
                
<span class="param-type"><a href="global.html#JobDefinition">JobDefinition</a></span>


            
            </td>

            

            

            <td class="description last"><p>The job object</p></td>
        </tr>

    

        <tr>
            
                <td class="name"><code>argumentRecipe</code></td>
            

            <td class="type">
            
                
<span class="param-type">string</span>


            
            </td>

            

            

            <td class="description last"><p>The recipe file path</p></td>
        </tr>

    
    </tbody>
</table>
















<h5>Returns:</h5>

        


<dl class="param-type">
    <dt>
        Type
    </dt>
    <dd>
        
<span class="param-type"><a href="global.html#JobDefinition">JobDefinition</a></span>


    </dd>
</dl>

    



        
            

    

    <h4 class="name" id="~_addJobs"><span class="type-signature">(async, private, inner) </span>_addJobs<span class="signature">()</span><span class="type-signature"> &rarr; {Array.&lt;<a href="global.html#JobDefinition">JobDefinition</a>>}</span></h4>

    




<dl class="details">

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="index.js.html">index.js</a>, <a href="index.js.html#line758">line 758</a>
    </li></ul></dd>
    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    
</dl>





<div class="description usertext">
    <p>An async function that construct each task object in the this.jobStore</p>
</div>

























<h5>Returns:</h5>

        
<div class="param-desc">
    <p>This process should fill the <code>this.taskLog</code> object with each process.</p>
</div>



<dl class="param-type">
    <dt>
        Type
    </dt>
    <dd>
        
<span class="param-type">Array.&lt;<a href="global.html#JobDefinition">JobDefinition</a>></span>


    </dd>
</dl>

    



        
            

    

    <h4 class="name" id="~_checkStatus"><span class="type-signature">(async, private, inner) </span>_checkStatus<span class="signature">()</span><span class="type-signature"> &rarr; {<a href="global.html#BatchStatus">BatchStatus</a>}</span></h4>

    




<dl class="details">

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="index.js.html">index.js</a>, <a href="index.js.html#line858">line 858</a>
    </li></ul></dd>
    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    
</dl>





<div class="description usertext">
    <p>This function checks job status and return the latest status object.
If finished/exited jobs detected, emit finish/error event on the this.runningJobs[jobID] eventEmitter.</p>
</div>

























<h5>Returns:</h5>

        
<div class="param-desc">
    <p>The updated batch status.</p>
</div>



<dl class="param-type">
    <dt>
        Type
    </dt>
    <dd>
        
<span class="param-type"><a href="global.html#BatchStatus">BatchStatus</a></span>


    </dd>
</dl>

    



        
            

    

    <h4 class="name" id="~_handleProxy"><span class="type-signature">(private, inner) </span>_handleProxy<span class="signature">(jobId, Proxy)</span><span class="type-signature"></span></h4>

    




<dl class="details">

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="index.js.html">index.js</a>, <a href="index.js.html#line446">line 446</a>
    </li></ul></dd>
    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    
</dl>





<div class="description usertext">
    <p>This private funciton handles the proxy registration and unregistration.</p>
</div>











    <h5>Parameters:</h5>
    

<table class="params">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        

        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>jobId</code></td>
            

            <td class="type">
            
                
<span class="param-type">string</span>


            
            </td>

            

            

            <td class="description last"><p>The job ID</p></td>
        </tr>

    

        <tr>
            
                <td class="name"><code>Proxy</code></td>
            

            <td class="type">
            
                
<span class="param-type"><a href="global.html#Proxy">Proxy</a></span>


            
            </td>

            

            

            <td class="description last"><p>(Optional) The proxy object to register. When not giving this proxy, this function unregisters the proxy.</p></td>
        </tr>

    
    </tbody>
</table>



















        
            

    

    <h4 class="name" id="~_jobAfterExitCallback"><span class="type-signature">(async, private, inner) </span>_jobAfterExitCallback<span class="signature">(jobId, fileHandler)</span><span class="type-signature"></span></h4>

    




<dl class="details">

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="index.js.html">index.js</a>, <a href="index.js.html#line582">line 582</a>
    </li></ul></dd>
    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    
</dl>





<div class="description usertext">
    <p>This internal function is called after the <code>jobExitCallback</code> function.
This function stores the resulting stdout/stderr files and updates the status of all jobs.</p>
</div>











    <h5>Parameters:</h5>
    

<table class="params">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        

        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>jobId</code></td>
            

            <td class="type">
            
                
<span class="param-type">string</span>


            
            </td>

            

            

            <td class="description last"></td>
        </tr>

    

        <tr>
            
                <td class="name"><code>fileHandler</code></td>
            

            <td class="type">
            
                
<span class="param-type"><a href="global.html#FileHandler">FileHandler</a></span>


            
            </td>

            

            

            <td class="description last"></td>
        </tr>

    
    </tbody>
</table>



















        
            

    

    <h4 class="name" id="~_jobBeforeExitCallback"><span class="type-signature">(async, private, inner) </span>_jobBeforeExitCallback<span class="signature">(jobId, fileHandler)</span><span class="type-signature"></span></h4>

    




<dl class="details">

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="index.js.html">index.js</a>, <a href="index.js.html#line513">line 513</a>
    </li></ul></dd>
    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    
</dl>





<div class="description usertext">
    <p>This internal function will be called right after a job has exited (finished or errored) and before the <code>jobExitCallback</code> function.
The function gets the remaining stdout/stderr messages, cleans up the streaming resources and unregisters the proxy.</p>
</div>











    <h5>Parameters:</h5>
    

<table class="params">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        

        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>jobId</code></td>
            

            <td class="type">
            
                
<span class="param-type">string</span>


            
            </td>

            

            

            <td class="description last"></td>
        </tr>

    

        <tr>
            
                <td class="name"><code>fileHandler</code></td>
            

            <td class="type">
            
                
<span class="param-type"><a href="global.html#FileHandler">FileHandler</a></span>


            
            </td>

            

            

            <td class="description last"></td>
        </tr>

    
    </tbody>
</table>



















        
            

    

    <h4 class="name" id="~_loadProgress"><span class="type-signature">(async, private, inner) </span>_loadProgress<span class="signature">()</span><span class="type-signature"></span></h4>

    




<dl class="details">

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="index.js.html">index.js</a>, <a href="index.js.html#line1012">line 1012</a>
    </li></ul></dd>
    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    
</dl>





<div class="description usertext">
    <p>This function loads the index.txt file in the <code>options.taskLogFolder</code> to check if jobs are finished with the <code>exitCode</code> of 0 (normal exit).
If the job is finished, then it is skipped. This is used for pipeline resuming if the running pipelines stop unexpectedly.</p>
</div>




























        
            

    

    <h4 class="name" id="~_monitorJobs"><span class="type-signature">(async, private, inner) </span>_monitorJobs<span class="signature">(queue)</span><span class="type-signature"></span></h4>

    




<dl class="details">

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="index.js.html">index.js</a>, <a href="index.js.html#line913">line 913</a>
    </li></ul></dd>
    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    
</dl>





<div class="description usertext">
    <p>This function is used to monitor job status and periodically checks job status.</p>
</div>











    <h5>Parameters:</h5>
    

<table class="params">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        

        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>queue</code></td>
            

            <td class="type">
            
            </td>

            

            

            <td class="description last"><p>The real queue object to deal the <code>this.runProcess</code> function of each job.</p></td>
        </tr>

    
    </tbody>
</table>



















        
            

    

    <h4 class="name" id="~_printStatus"><span class="type-signature">(inner) </span>_printStatus<span class="signature">(currentStatus)</span><span class="type-signature"></span></h4>

    




<dl class="details">

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="index.js.html">index.js</a>, <a href="index.js.html#line389">line 389</a>
    </li></ul></dd>
    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    
</dl>















    <h5>Parameters:</h5>
    

<table class="params">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        

        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>currentStatus</code></td>
            

            <td class="type">
            
                
<span class="param-type"><a href="global.html#BatchStatus">BatchStatus</a></span>


            
            </td>

            

            

            <td class="description last"><p>The current status object with the fields {pending, queued, running, finishing, exit, done, total};
This function is used to print job progress in a batch task to stdout and stderr. You may customize this function for your prferred style.</p></td>
        </tr>

    
    </tbody>
</table>



















        
            

    

    <h4 class="name" id="~_resumeJobs"><span class="type-signature">(async, private, inner) </span>_resumeJobs<span class="signature">()</span><span class="type-signature"></span></h4>

    




<dl class="details">

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="index.js.html">index.js</a>, <a href="index.js.html#line1062">line 1062</a>
    </li></ul></dd>
    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    
</dl>





<div class="description usertext">
    <p>This function trying to fetch remote jobs.
This is perticularly useful when adapter process somehow closed and re-run the same adapter process.
Instead of directly re-creation of non-fnihsing jobs, adapter trys to fetch the job histroy.
Then, the adapter can see if there is a need to re-submit jobs.</p>
</div>




























        
            

    

    <h4 class="name" id="~_runJob"><span class="type-signature">(async, private, inner) </span>_runJob<span class="signature">(jobId)</span><span class="type-signature"> &rarr; {promise}</span></h4>

    




<dl class="details">

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="index.js.html">index.js</a>, <a href="index.js.html#line612">line 612</a>
    </li></ul></dd>
    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    
</dl>





<div class="description usertext">
    <p>An async function that used to run a single job.</p>
</div>











    <h5>Parameters:</h5>
    

<table class="params">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        

        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>jobId</code></td>
            

            <td class="type">
            
                
<span class="param-type">string</span>


            
            </td>

            

            

            <td class="description last"><p>The auto-generated and uniqe job ID</p></td>
        </tr>

    
    </tbody>
</table>
















<h5>Returns:</h5>

        
<div class="param-desc">
    <p>A promise object that will be resovled when the task is finished normally and will be rejected when the task has errors (exitCode !== 0) or leaves unexpectedly.</p>
</div>



<dl class="param-type">
    <dt>
        Type
    </dt>
    <dd>
        
<span class="param-type">promise</span>


    </dd>
</dl>

    



        
            

    

    <h4 class="name" id="~_runTasks"><span class="type-signature">(async, private, inner) </span>_runTasks<span class="signature">()</span><span class="type-signature"></span></h4>

    




<dl class="details">

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="index.js.html">index.js</a>, <a href="index.js.html#line1143">line 1143</a>
    </li></ul></dd>
    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    
</dl>





<div class="description usertext">
    <p>The core function to initiate the queue to process tasks.</p>
</div>




























        
            

    

    <h4 class="name" id="~_sendMsgToBdpClient"><span class="type-signature">(private, inner) </span>_sendMsgToBdpClient<span class="signature">(action, content)</span><span class="type-signature"></span></h4>

    




<dl class="details">

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="index.js.html">index.js</a>, <a href="index.js.html#line435">line 435</a>
    </li></ul></dd>
    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    
</dl>





<div class="description usertext">
    <p>This private function sends messages to bdp-server with process.send.</p>
</div>











    <h5>Parameters:</h5>
    

<table class="params">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        

        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>action</code></td>
            

            <td class="type">
            
                
<span class="param-type">string</span>


            
            </td>

            

            

            <td class="description last"><p>The message action type. The current possible values are 'registerProxy' or 'unregisterProxy'.</p></td>
        </tr>

    

        <tr>
            
                <td class="name"><code>content</code></td>
            

            <td class="type">
            
                
<span class="param-type">object</span>


            
            </td>

            

            

            <td class="description last"><p>The message content object of any types.</p></td>
        </tr>

    
    </tbody>
</table>



















        
            

    

    <h4 class="name" id="~_waitingJobStatus"><span class="type-signature">(async, private, inner) </span>_waitingJobStatus<span class="signature">(timeout)</span><span class="type-signature"></span></h4>

    




<dl class="details">

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="index.js.html">index.js</a>, <a href="index.js.html#line1250">line 1250</a>
    </li></ul></dd>
    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    
</dl>





<div class="description usertext">
    <p>This internal function waits until all job object are resolved (having their own exit codes).</p>
</div>











    <h5>Parameters:</h5>
    

<table class="params">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        

        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>timeout</code></td>
            

            <td class="type">
            
                
<span class="param-type">*</span>


            
            </td>

            

            

            <td class="description last"></td>
        </tr>

    
    </tbody>
</table>



















        
            

    

    <h4 class="name" id="~_writeJobLogs"><span class="type-signature">(async, private, inner) </span>_writeJobLogs<span class="signature">()</span><span class="type-signature"></span></h4>

    




<dl class="details">

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="index.js.html">index.js</a>, <a href="index.js.html#line950">line 950</a>
    </li></ul></dd>
    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    
</dl>





<div class="description usertext">
    <p>Writing task progress to the the <code>progress-index.txt</code> file</p>
</div>




























        
            

    

    <h4 class="name" id="~setOptions"><span class="type-signature">(inner) </span>setOptions<span class="signature">(options)</span><span class="type-signature"> &rarr; {<a href="global.html#AdapterOption">AdapterOption</a>}</span></h4>

    




<dl class="details">

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="index.js.html">index.js</a>, <a href="index.js.html#line346">line 346</a>
    </li></ul></dd>
    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    
</dl>





<div class="description usertext">
    <p>You may using this in your adapter class, such as <code>super._setOptions(options)</code>.</p>
</div>











    <h5>Parameters:</h5>
    

<table class="params">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        

        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>options</code></td>
            

            <td class="type">
            
                
<span class="param-type"><a href="global.html#AdapterOption">AdapterOption</a></span>


            
            </td>

            

            

            <td class="description last"></td>
        </tr>

    
    </tbody>
</table>
















<h5>Returns:</h5>

        


<dl class="param-type">
    <dt>
        Type
    </dt>
    <dd>
        
<span class="param-type"><a href="global.html#AdapterOption">AdapterOption</a></span>


    </dd>
</dl>

    



        
    

    

    
</article>

</section>




    
    
</div>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 3.6.7</a> on Sun Jun 13 2021 17:45:27 GMT+0800 (台北標準時間) using the <a href="https://github.com/clenemt/docdash">docdash</a> theme.
</footer>

<script>prettyPrint();</script>
<script src="scripts/polyfill.js"></script>
<script src="scripts/linenumber.js"></script>

<script src="scripts/search.js" defer></script>



</body>
</html>